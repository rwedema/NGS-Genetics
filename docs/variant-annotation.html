<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Week 4 Variant Annotation | Case background information and exercises</title>
<meta name="author" content="Marcel Kempenaar and Ronald Wedema">
<meta name="description" content="In the - for now - final Galaxy workflow step for analyzing our patient, we are going to annotate all our filtered variants to determine the severity of the variations we determined last time with...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Week 4 Variant Annotation | Case background information and exercises">
<meta property="og:type" content="book">
<meta property="og:description" content="In the - for now - final Galaxy workflow step for analyzing our patient, we are going to annotate all our filtered variants to determine the severity of the variations we determined last time with...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Week 4 Variant Annotation | Case background information and exercises">
<meta name="twitter:description" content="In the - for now - final Galaxy workflow step for analyzing our patient, we are going to annotate all our filtered variants to determine the severity of the variations we determined last time with...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Case background information and exercises</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="intro-ngs-and-genetics-project.html"><span class="header-section-number">1</span> Intro NGS and Genetics Project</a></li>
<li><a class="" href="read-mapping.html"><span class="header-section-number">2</span> Read Mapping</a></li>
<li><a class="" href="analysis-of-cardiopanel-variants.html"><span class="header-section-number">3</span> Analysis of Cardiopanel Variants</a></li>
<li><a class="active" href="variant-annotation.html"><span class="header-section-number">4</span> Variant Annotation</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rwedema/NGS-Genetics/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="variant-annotation" class="section level1" number="4">
<h1>
<span class="header-section-number">Week 4</span> Variant Annotation<a class="anchor" aria-label="anchor" href="#variant-annotation"><i class="fas fa-link"></i></a>
</h1>
<p>In the - for now - final Galaxy workflow step for analyzing our patient, we are going to annotate all our filtered variants to determine the severity of the variations we determined last time with the <code>LoFreq</code> tool. This involves comparing all our variants against a number of databases containing <em>annotation data</em> for known variants. We will use our filtered <code>VCF</code>-file resulting from LoFreq so we need to upload our newly created VCF file to Galaxy. Make sure that Galaxy recognizes the file type by selecting the correct file type when uploading or change it afterwards using the <em>Edit attributes</em> button.</p>
<div class="inline-figure"><img src="images/upload.png" width="432"></div>
<div id="snpeff-and-snpsift" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> SnpEff and SnpSift<a class="anchor" aria-label="anchor" href="#snpeff-and-snpsift"><i class="fas fa-link"></i></a>
</h2>
<p>There are multiple methods of annotating found variants. Most of these will require extra data to predict the effect of a variant or to compare it with a known set of variants. Here we use a set of tools that does both types of annotation. See for further details and a manual the <a href="http://pcingola.github.io/SnpEff/">Github documentation</a>.</p>
<ul>
<li>
<strong><code>SnpEff</code></strong>: <em>is a variant annotation and effect prediction tool. It annotates and predicts the effects of genetic variants (such as amino acid changes)</em>
</li>
<li>
<strong><code>SnpSift</code></strong>: <em>is a toolbox that allows you to filter and manipulate annotated files.</em>
<ul>
<li>actually, this tool also annotates variants using a variety of data sources, for which we will use it.</li>
</ul>
</li>
</ul>
<p>Both tools are available in Galaxy with numerous sub-tools depending on the task that you want to do. To get the most information for each variant, we will perform three annotation <em>runs</em>:</p>
<p><strong>Step 1</strong>: Using SnpEff to annotate variants using the <code>GRCh38.86</code> database adding information related to the gene, transcript and protein that are affected by this variant. This results in a lot of extra data that is all documented in the changed VCF header.</p>
<p>For example, given the following variant as input:</p>
<blockquote>
<p><code>chr1 237550644   .   C   A   91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5</code></p>
</blockquote>
<p>This is the result after SnpEff:</p>
<blockquote>
<p><code>chr1 237550644   .   C   A   91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5;ANN=A|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000366574.6|protein_coding|27/105|c.3167C&gt;A|p.Thr1056Lys|3484/16562|3167/14904|1056/4967||,A|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000360064.7|protein_coding|25/103|c.3119C&gt;A|p.Thr1040Lys|3119/14850|3119/14850|1040/4949||WARNING_TRANSCRIPT_NO_START_CODON,A|downstream_gene_variant|MODIFIER|SNORA25|ENSG00000252290|transcript|ENST00000516481.1|snoRNA||n.*4396G&gt;T|||||4396|</code></p>
</blockquote>
<p>All details are added in the <code>ANN</code> field. See the description in the VCF header for a field-by-field explanation of the values.</p>
<p><strong>Running SnpEff</strong>:</p>
<ul>
<li>Select the <code>SnpEff Variant effect and annotation</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.</li>
<li>Select the uploaded VCF file containing the variants filtered for the cardiopanel genes.</li>
<li>Check if the by default selected <code>GRCh38.86</code> <em>Genome Source</em> is selected.</li>
<li>All other settings can be left default, execute the tool.</li>
</ul>
<p>The result consists of two files: an annotated VCF file and a web-report on all the variants and their predicted effects.</p>
<p><strong>Step 2</strong>: Adding <code>dbSnp</code> entries using <code>SnpSift</code>. The <a href="https://www.ncbi.nlm.nih.gov/snp/">dbSnp</a> database contains information on known variants. The version that also includes clinical significance (combining the ClinVar database) is available for the SnpSift tool in Galaxy.</p>
<p><strong>Running SnpSift for dbsnp</strong>:</p>
<ul>
<li>SnpSift requires the <code>dbSnp</code> database to be available in your history:
<ul>
<li>In Galaxy, go to <code>Shared Data</code> (top menu) –&gt; <code>Data Libraries</code> –&gt; <code>dbSnp</code> library</li>
<li>Select both files shown there and use the <code>Add to history</code> –&gt; <code>as datasets</code> option to get them in your own history</li>
</ul>
</li>
<li>Select the <code>SnpSift Annotate SNPs from dbSnp</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.
<ul>
<li>
<strong>Note</strong>: this is a different tool from the <code>dbNSFP</code> database, see step #3 below.</li>
</ul>
</li>
<li>Select the output VCF file created by SnpEff in step #1 as the <code>Variant input file</code>.</li>
<li>Select the <code>dbSnp_clinvar.vcf.gz</code> file as the <code>VCF File with ID field annotated</code>.</li>
<li>For <code>Fields to annotate</code> select the <code>Add also INFO fields</code> option and execute the tool.</li>
</ul>
<p>This tool adds annotations in two columns. First, the <code>ID</code> column will describe the <code>dbSnp</code> ID (rs number) that can be used to look up the variant. Second, the <code>INFO</code> column is expanded with (a lot of) extra information if the variant is known. For instance, the ClinVar data might report on diseases the variant is related to, such as:</p>
<blockquote>
<p><code>CLNDN=Cardiovascular_phenotype|Charcot-Marie-Tooth_disease|Lipoatrophy_with_Diabetes,_Hepatic_Steatosis,_Hypertrophic_Cardiomyopathy,_and_Leukomelanodermic_Papules</code></p>
</blockquote>
<p><strong>Step 3</strong>: Annotating using the <code>dbNSFP</code> database and SnpSift. The dbNSFP database is a huge collection (over 300GB of text files) of annotation sources combined into a single database. The SnpSift tool can compare our variants with known variants from all of these annotation sources and - like the first few steps - adds them to our VCF file. As you can expect, our VCF file will become very large and most likely unreadable. Therefore, we re-use the VCF file gained from step #1 instead of the VCF file from SnpSift in step #2. We can later combine the data after parsing both files separately.</p>
<p><strong>Running SnpSift for dbNSFP</strong>:</p>
<ul>
<li>Select the <code>SnpSift dbNSFP</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.</li>
<li>Use the VCF file from step #1 as input</li>
<li>Select the locally available <code>GRCh38 dbNSFP4.3c</code> Genome database</li>
<li>Select all options for the <code>Annotate with</code> option</li>
</ul>
<p>Note that the tool description lists output not available for selection, we will look into the specifics of all selected databases later on.</p>
<!--

Commandline SnpEff and SnpSift for 2.1.2

Step #1 SnpEff

cd /local-fs/datasets/dbNSFP/snpEff/;
java -jar snpEff.jar ann GRCh38.105 /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

Step #2 SnpSift - dbSnp

/local-fs/datasets/dbNSFP/snpEff/scripts/snpSift annotate /local-fs/datasets/dbNSFP/snpEff/data/clinvar.vcf.gz /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

Step #3 SnpSift - dbNSFP with all options:

/local-fs/datasets/dbNSFP/snpEff/scripts/snpSift DbNsfp -db /data/datasets/dbNSFP/snpEff/data/dbNSFP4.3c.txt.gz /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

-->
<div id="assignment" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> Assignment<a class="anchor" aria-label="anchor" href="#assignment"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Create a table in your report where you summarize the added annotation data (very!) briefly;
<ul>
<li>The database where the data comes from</li>
<li>The result or value (is it an identifier, a percentage, etc.).</li>
<li>
<strong>Hint</strong>: you can add formatted tables in markdown with some syntax which is easiest generated at <a href="www.tablesgenerator.com/markdown_tables">https://www.tablesgenerator.com</a>
</li>
</ul>
</li>
</ul>
<p>The VCF header only describes the names of the databases the data originates from and does not give a clear explanation. There might be a single source for the documentation (please let us know if you find it!), but for now the best method of getting information about the added data is:</p>
<ul>
<li>
<strong>Step #1</strong>: the output of the first step also includes a web report that at least gives more details on the results. Either use your biological knowledge or search for terms if they’re unclear</li>
<li>
<strong>Step #2</strong>: data from the <code>dbSnp</code> database comes from the ‘ClinVar’ version of this database, which is documented <a href="https://www.ncbi.nlm.nih.gov/variation/docs/ClinVar_vcf_files/">on its NCBI website</a>.</li>
<li>
<strong>Step #3</strong>: for the <code>dbNSFP</code> database there are descriptions available on the online version:
<ul>
<li>Go to <a href="http://database.liulab.science/dbNSFPconn">the online dbNSFP instance</a>, select the <strong>Academic</strong> option and click <strong>Connect</strong>.</li>
<li>If you hover over any of the selectable Variant fields, you can read a brief description of the data that is added.</li>
<li>Note that this is for dbNSFP version 4.4a and we use version 4.3c (very minor differences)</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="programming-assignment-analyzing-variant-annotation" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Programming Assignment; Analyzing Variant Annotation<a class="anchor" aria-label="anchor" href="#programming-assignment-analyzing-variant-annotation"><i class="fas fa-link"></i></a>
</h2>
<p>Given the possibly hundreds of annotated variants with data from multiple data sources, it’s time to do one last <em>filtering</em> on the data to come up with a list of variants of which we can say, with some certainty, that they are related to the condition. As with the VCF-filter tool that we’ve written, here too will we check each line and decide if it is a variant worth reporting on. Whether we want to keep a variant or not depends on the annotation added by SnpEff/SnpSift and it is your task to come up with an approach for <strong>combining</strong> data from these data sources to <em>rank</em> the annotated variants.</p>
<div id="assignment-10-data-preparation" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Assignment 10; Data Preparation<a class="anchor" aria-label="anchor" href="#assignment-10-data-preparation"><i class="fas fa-link"></i></a>
</h3>
<p>This programming assignment asks to take another good look at the data, but now in R to see if everything is in a suitable format to eventually sort the data and extract a top-set of variants related to the condition. As you have seen, all data is essentially stored in a single column that contains multiple separators (such as <code>|</code> and <code>;</code>). You need to think of and implement a good strategy to convert all this information into a workable data format, such as a data frame.</p>
<p>There are a few caveats though that can also be seen when looking at the SnpEff report (the ‘stats’ output). For instance, there are two lines in the overview table that describe the amount of variants and the amount of hits in the SnpEff database:</p>
<ul>
<li><code>Number of variants (before filter)       145</code></li>
<li><code>Number of effects        1,332</code></li>
</ul>
<p>Which means that on average every variant has about 10 (!) hits of which all data is placed in the <code>INFO</code> column (most notably in the <code>ANN</code> part of the <code>INFO</code> column). This is caused most often by multiple transcripts (alternative splicing) being affected by this variant. This makes it very difficult to parse and therefore this section gives tips and example code to assist in that task. With this much data from three different steps it is too complex to assess in a single run so we will assess annotation data step by step.</p>
<div id="step-1-2-snpeff-ann-data-and-snpsift-clinvar-data" class="section level4" number="4.2.1.1">
<h4>
<span class="header-section-number">4.2.1.1</span> Step #1 &amp; #2; SnpEff ANN data and SnpSift ClinVar data<a class="anchor" aria-label="anchor" href="#step-1-2-snpeff-ann-data-and-snpsift-clinvar-data"><i class="fas fa-link"></i></a>
</h4>
<p>According to the VCF header, the <code>ANN</code> data contains the values explained in the <a href="https://pcingola.github.io/SnpEff/se_inputoutput/#ann-field-vcf-output-files">SnpEff documentation</a>. Some, or all of them could be of interest. There is a Galaxy tool available to extract interesting fields from the added data.</p>
<ul>
<li>Select the <code>SnpSift Extract Fields from a VCF file into a tabular file</code> tool from the tool menu
<ul>
<li>the tool help or <a href="https://pcingola.github.io/SnpEff/snpsift/extractfields/">this manual</a> can provide more details</li>
</ul>
</li>
<li>Select the annotated VCF file as input</li>
<li>Provide the names of the columns of interest. For instance, the following could be used as a query for the ‘Fields to extract’:
<ul>
<li><code>CHROM POS REF ALT ANN[*].EFFECT ANN[*].IMPACT ANN[*].GENE ANN[*].FEATURE ANN[*].FEATUREID ANN[*].BIOTYPE ANN[*].ERRORS CLNDN CLNSIG</code></li>
<li>Add or remove any other column you find interesting to the above query.</li>
</ul>
</li>
<li>Enable the ‘One effect per line’ option</li>
<li>Run the tool and download the resulting tabular file for analysis in R
<ul>
<li>The resulting file contains as many rows as effects reported by SnpEff (1332 in this example)</li>
</ul>
</li>
</ul>
<div class="rmdnote">
<p>Note: always include the <code>CHROM POS REF ALT</code> columns which are needed to identify the variant in the original file.</p>
</div>
</div>
<div id="step-3-snpsift-dbnsfp" class="section level4" number="4.2.1.2">
<h4>
<span class="header-section-number">4.2.1.2</span> Step #3; SnpSift dbNSFP<a class="anchor" aria-label="anchor" href="#step-3-snpsift-dbnsfp"><i class="fas fa-link"></i></a>
</h4>
<p>Similar to the previous step, extract the fields of interest using the <code>SnpSift Extract Fields from a VCF file into a tabular file</code> tool. The <code>dbNSFP</code> entries are all prefixed with <code>dbNSFP_</code>, for instance: <code>dbNSFP_MutationAssessor_score</code> and <code>dbNSFP_SIFT_pred</code>. Once done, download this tabular file too for further analysis.</p>
</div>
</div>
<div id="assignment-11-finding-variants-of-interest" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Assignment 11; Finding Variants of Interest<a class="anchor" aria-label="anchor" href="#assignment-11-finding-variants-of-interest"><i class="fas fa-link"></i></a>
</h3>
<p>Given the knowledge we have on the data stored in the two dataframes, we can now formulate questions for this data to find a set of variants which are most likely linked to the cardiomyopathy condition. This condition cannot be identified by a single variant but is often caused by several variants and the combination not only determines <em>if</em> someone suffers from cardiomyopathy but also how <em>badly</em> their condition is.</p>
<p>The physician who diagnoses patients uses the genetic information of the found variants as one of the sources for confirming the condition. However, presenting a list of 100+ variant positions with a list of numbers from some tools is not how that works in practice; we need to present a short, ordered list of variants that can be related to the condition.</p>
<p>Next, define your own sorting, filtering, selecting, etc. procedure to filter and order a top-list of variants that you’d present as aid to a diagnoses. For instance, you might have a variant that had a hit in the ClinVar database which directly links it to cardiomyopathy, this should probably be somewhere around the top of your list. Again, look at the output description that you’ve written earlier to come up with combination(s) of values. There is no golden standard for selecting these variants so it is very important to properly document and argument your decisions.</p>
<p>As an end product for this step you are expected to include a nice table including at least 10 variants in your report that contains all relevant information for each of them, i.e. the chromomsome, position, reference and variant nucleotides, gene name and all relevant scores.</p>
<p>For all of your variants, try to (briefly!) answer the following questions for each variant:</p>
<ul>
<li>Can you find a link between cardiomyopathy and the variant?</li>
<li>What is the effect of the variant?</li>
<li>Is it validated?</li>
<li>Are there scientific studies supporting the evidence?</li>
<li>What does the score indicate?</li>
<li>What else can you find about the variant?</li>
</ul>
<p>You can use the following online sources among others:</p>
<ul>
<li><a href="http://www.ncbi.nlm.nih.gov/snp/" class="uri">http://www.ncbi.nlm.nih.gov/snp/</a></li>
<li><a href="http://www.ncbi.nlm.nih.gov/variation/tools/1000genomes/" class="uri">http://www.ncbi.nlm.nih.gov/variation/tools/1000genomes/</a></li>
<li><a href="http://www.ncbi.nlm.nih.gov/projects/SNP/" class="uri">http://www.ncbi.nlm.nih.gov/projects/SNP/</a></li>
</ul>
</div>
</div>
<div id="galaxy-workflow" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Galaxy Workflow<a class="anchor" aria-label="anchor" href="#galaxy-workflow"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have completed our analysis steps we can create a <strong>Galaxy workflow</strong>. In this workflow we will combine all the tools that we have used in Galaxy (FastQ files –&gt; SnpEff/SnpSift annotated output) so that when we receive new patient data in the future we can analyze that dataset with a single click!</p>
<p>There are many <a href="https://galaxyproject.org/learn/advanced-workflow/">online resources</a> giving instructions and examples for creating Galaxy workflows, use these resources to create a workflow including all used analysis tools. Note that you can convert Galaxy histories into workflow(s), which saves a lot of time with configuring all the tools from that workfow.</p>
<p>Once you have a workflow, make sure it is shared with your project partner and create a screenshot of it for your report (try to fit all tools in a single image).</p>
<p><strong>Note</strong>; this assignment has a very low priority and should be done once you are satisfied with all other parts of your work! At the bare minimum, open your last history (including SnpEff/SnpSift) and explore/ play with the <code>Extract Workflow</code> option.</p>
</div>
<div id="comparative-genomics" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Comparative Genomics<a class="anchor" aria-label="anchor" href="#comparative-genomics"><i class="fas fa-link"></i></a>
</h2>
<p>With the complete analysis nicely packaged into a single workflow, one thing that we can use it for is to do <em>comparative genomics</em>. This term contains many different types of comparisons and is described on Wikipedia as</p>
<blockquote>
<p><em>Comparative genomics is a field of biological research in which the genomic features of different organisms are compared.</em></p>
</blockquote>
<p>These features can be of many types and in our case they are the variants. A simple tool is available in Galaxy called <em>VCF-VCFintersect</em> that performs either <em>intersection</em> or <em>union</em> on two VCF datasets containing variant data. This tool compares two VCF files and retains either the shared variants (intersection) or all variants combined (union) as shown in the diagram below.</p>
<div class="inline-figure"><img src="images/intersect_union.png" width="310"></div>
<p><strong>Assignment</strong></p>
<ul>
<li>Process another patient sample (use a new history) by running your complete workflow.
<ul>
<li>Note that you have to filter the resulting SnpEff output (which contains the same data as the VCF file appended with annotation data) with the BED-data. Alternatively, you can stop after the LoFreq tool, download the VCF file, filter this using the BED-data and re-upload the filtered VCF file before continuing with SnpEff</li>
</ul>
</li>
<li>Calculate the following three statistics:
<ul>
<li>The number of variants unique to patient 1</li>
<li>The number of variants unique to patient 2</li>
<li>The number of variants found in both patients</li>
</ul>
</li>
<li>Create a VENN-diagram (like the image above) displaying these numbers.</li>
</ul>
</div>
<div id="galaxy-data-cleanup" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Galaxy Data Cleanup<a class="anchor" aria-label="anchor" href="#galaxy-data-cleanup"><i class="fas fa-link"></i></a>
</h2>
<p>As a final closing assignment we ask you to clean up the Galaxy histories to save some space because it is difficult for the admin(s) to perform this cleaning for you. Once all products are finished, please consider removing all large files from your history, such as the outputs of the trimming (Trimmomatic), mapping (BWA), duplicate read marking (MarkDuplicates) and the pileup steps (Mpileup). For the large files, please make sure that you <em>also</em> click the <em>Permanently remove it from disk</em> link.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="analysis-of-cardiopanel-variants.html"><span class="header-section-number">3</span> Analysis of Cardiopanel Variants</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#variant-annotation"><span class="header-section-number">4</span> Variant Annotation</a></li>
<li>
<a class="nav-link" href="#snpeff-and-snpsift"><span class="header-section-number">4.1</span> SnpEff and SnpSift</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#assignment"><span class="header-section-number">4.1.1</span> Assignment</a></li></ul>
</li>
<li>
<a class="nav-link" href="#programming-assignment-analyzing-variant-annotation"><span class="header-section-number">4.2</span> Programming Assignment; Analyzing Variant Annotation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assignment-10-data-preparation"><span class="header-section-number">4.2.1</span> Assignment 10; Data Preparation</a></li>
<li><a class="nav-link" href="#assignment-11-finding-variants-of-interest"><span class="header-section-number">4.2.2</span> Assignment 11; Finding Variants of Interest</a></li>
</ul>
</li>
<li><a class="nav-link" href="#galaxy-workflow"><span class="header-section-number">4.3</span> Galaxy Workflow</a></li>
<li><a class="nav-link" href="#comparative-genomics"><span class="header-section-number">4.4</span> Comparative Genomics</a></li>
<li><a class="nav-link" href="#galaxy-data-cleanup"><span class="header-section-number">4.5</span> Galaxy Data Cleanup</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rwedema/NGS-Genetics//blob/master/04-Week4-Annotation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rwedema/NGS-Genetics//edit/master/04-Week4-Annotation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Case background information and exercises</strong>" was written by Marcel Kempenaar and Ronald Wedema. It was last built on 2023-10-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
