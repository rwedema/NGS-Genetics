[{"path":"index.html","id":"about","chapter":"About","heading":"About","text":"syllabus module 2.1.1 NGS_en_Genetics.\nbookdown document provide enough background material exercises complete Case part module. Also links genetics presentations given can found schedule .","code":""},{"path":"index.html","id":"usage","chapter":"About","heading":"Usage","text":"Chapters divided subjects. subject (chapter) last week complete. new information week 4 rest weeks spend finishing analysis selected case preparing genetics exam.","code":""},{"path":"index.html","id":"learning-outcomes","chapter":"About","heading":"0.1 Learning outcomes","text":"good understanding concepts central dogma, different types macromolecules, enzymes, can describe interconnections.can identify various mechanisms gene regulation predict effects different mutations gene expression.familiar different genome structures can detect, filter, annotate NGS (Next-Generation Sequencing) dataset using appropriate tools techniques.clear understanding quality requirements NGS data, depending NGS technique used objective. can also apply tools assess improve quality data.aware available tools algorithms mapping NGS reads reference genome, can justify one best suited given dataset question.can provide arguments present choices made process achieving high-quality mapping.","code":""},{"path":"index.html","id":"end-products","chapter":"About","heading":"0.2 End Products","text":"end products course following two items: * \ngenetics exam (weight 3/5) * Analysis selected case\n(weight 2/5)two items weighted combined get single end graded. See also Rubric learning outcomes graded.","code":""},{"path":"index.html","id":"rubric","chapter":"About","heading":"0.3 Rubric","text":"","code":""},{"path":"index.html","id":"schedule-and-deliverables","chapter":"About","heading":"0.4 Schedule and deliverables","text":"","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"intro-ngs-and-genetics-project","chapter":"Week 1 Intro NGS and Genetics Project","heading":"Week 1 Intro NGS and Genetics Project","text":"project learn bioinformatic basics \nanalyse Next-Generation Sequence (NGS) data patients diagnosed cardiomyopathy. Using \ncase discover genetic variations genomic data \npatient suspected condition. end-goal identify \nreport genomic variations possibly disease causing.\ncourse material can found document, theory, lot\nlinks resources, questions assignments.Hypertrophic cardiomyopathyArrhythmogenic right ventricular cardiomyopathy (ARVC)LV non-compactionIon ChannelopathiesDilated cardiomyopathy (DCM)Restrictive cardiomyopathy (RCM)human genetics department University Medical Center Groningen diagnoses patients suspected suffer cardiomyopathy. diagnosis, patients genome compared set reference genes known involved disease (called gene panel). variations found checked compared known variants classify score severity. Using variations type (dilated, restrictive, etc.) disease severe can diagnosed, combined regular data sources (physical exam, EKG, etc.).Investigate case detail log findings. Report following:impact disease patientIs just one type disease can divided multiple categoriesAre known genes involved association backed-scientific literatureDuring diagnosis, patients genome compared set \nreference genes known involved disease (called gene panel). variations found checked compared known\nvariants classify score severity. Using variations\ndisease can detected diagnosed.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"tools","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.1 Tools","text":"project work many different software tools \nreplicate genetic diagnoses process, available either \ndownload computer now using. tools going\ncreate ! tools however perform important steps\nanalysis process involve:checking quality input data,mapping data reference genome (comparing ‘known’ data),finding variations respect reference andscoring found variations probabilty disease causing.Normally steps involve many seperate tools need run \ncommandline, however course using worflow\nmanager \ntools available can joined together form\nlogical steps analysis process. workflow manager used \ncourse Galaxy\n(wikipedia,\nwebsite), worflow managers exist\n: CLC\nBio,\nTaverna,\nNextgene \nSnakeMake. \nlikely encounter one workflow managers \nfuture professional carreer, many scientific laboratories \nbiomedical research help tools organised workflow\nmanagers.Next advantage coupling multiple tools together \nworkflow, Galaxy ideal translation often hard--use\ncommandline tools easy--use large audience offering\nsimple graphical interfaces.Actually one reasons following course \nbecome proficient also using commandline tools combining\nworkflow (also called pipeline) non-technical\nresearchers can use !Week 1 course starts explaining Galaxy \ncan use analyze data, first introduce \ndiscuss data working .","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"data","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.2 Data","text":"bioinformatician often create data analyze\ncome lab - project - \nsequencer. sequencer (Illumina Miseq\nyoutube, many sequencing technologies exist learn seperate lecture) generates sequencing data\nbiological sample. Sequencing data cases introduced \nmodule come genome data. different module (2.1.2),\nalso learn work transcriptomics data (RNA).first step performing called sequencing run \nsample-preparation. project fase used filter \nisolated DNA exons genes interest (consisting\none exons EXpressed regiONs) kept, method \ncalled exome\nsequencing.targeting specific genes (called gene panel) omit bulk genome, \nimportant consequence. human genome contains 26.564 genes \n233.785 exons combined (looking human genome build 2003). \ncan get data selectively targeting genes interest, instead \ntrying read whole exome. Can think reason \ntrue?DNA included genes interest thus also exons\n(somewhere around 98% DNA) sequenced, therefore \ntotal ~3.2 billion basepairs small fraction basepairs \nactually sequenced. greatly depends case selected number genes present gene panel, typically small percentage usually less 1% genome.actual data using stored relatively simple\ntext-files containing sequenced letters (, C, G T) along \ndata primarily used describe quality sequenced base.\nGiven sequencing technology (Illumina MiSeq) used generate \nsequencing data, limited machine’s technical capabilities\ngenerate data. case MiSeq means \nunfortunately long continues sequenced can produced. \nfiles generated MiSeq contain millions short sequences (~150\nbasepairs , called sequence read) particular order.\nchallenge using data answer initial question (\nspecific variations (mutations) responsible acquiring \ndisease) find sequences originate \ncan compare patients sequence sequence healthy\nindividual. comparison can find variation\nthus begin answering question.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"analysis","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.3 Analysis","text":"course consists number documents like \nworked -order. first section documents\nshows analysis steps next. also\nshows tools going use assignments\nincluded.note document first week long \ncontain many assignments. purpose since goal\nweek primarily understand:goal course iswhat disease looking ?question(s) want answer?tools usingwhat Galaxy website? follow tutorial get familiar itwhat kind tools available Galaxy?data use throughout coursehow data generated?analysis steps needed answer research question?good scanning documents can easily spot actual\nassignments first chapter complete two hours\n(note; challenge!). However, ask \nanswer explain questions probably \nhard time. summarize, make sure general theory \nshown clear end chapter.Either follow links external resources, use google (works pretty well) search terms techniques Youtube. Without knowledge, manage follow steps first weeks surely struggle later need make decisions . final grade based complete assignments, also level understanding show final presentation subject.begin practical new week (chapter) first group discussing \nprevious week.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"literature","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.4 Literature","text":"explicit book case text need read, \nlot online material available use encounter\nunknown terms concepts. article titled ‘Review Current\nMethods, Applications, Data Management Bioinformatics\nAnalysis Whole Exome\nSequencing’\ndiscusses complete process analyzing raw sequencing data \nvariant analysis goes beyond scope project \ngood read.course, topics lectures prepare genetics exam also topics need understand able successfully complete case.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"reporting","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.5 Reporting","text":"help work trough document prepare best \npossible final presentation best keep track \nanalysis steps findings.already learned “Wetenschappelijke Cyclus”\nmodule, type document called R\nMarkdown suitable \npurpose. document can write combination text code\nresults (tables figures) included well.\nTherefore, suitable lab-journal course.imposed rules report progress since \ncomparable normal written report (chapters called\n‘introduction’, ‘results’, etc.), just try keep organized, clearly\nstate important \nresults belong . note however use figures tables\n(please !), provide clear caption explain \nshowing. logfile part grading (next module \n!), just convenient way keep track steps\nresults.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"assignments-week1","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6 Assignments week1","text":"","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"galaxy-server","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.1 Galaxy Server","text":"main ‘tool’ ((web)platform)\ncontaining actual tools performing analysis use course.\nSince spending lot time Galaxy start learning use .\nNote lot Galaxy servers available use worldwide\nserver probably contains different set implemented tools. Typically, different labs Galaxy server host just tool important particular lab run analyses.\nmain galaxy server available https://usegalaxy.org \nfine learning galaxy (section ) won’t used\nlater (see section ) \nregister server.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"learning-galaxy","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.1.1 Learning Galaxy","text":"Start following beginner tutorial available Galaxy\nTraining collection\n- old - Galaxy Learn\nwiki page. First, browse page see available (can \nused later ) choose interesting (beginners!) tutorial \ntry. tutorials either relavant --date, \nneed learn least following concepts:Creating new history rename current - empty - historyUploading data local fileFinding/ selecting toolSelecting input data toolchanging settings toolExecuting toolUsing History View tool-outputRe-run toolDelete elementsSelect copy elements new historyAnd - preferably - something creating workflow (item explained later )need report tutorial followed/ video tutorial\nwatched.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"bioinformatics-galaxy-server","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.1.2 Bioinformatics Galaxy Server","text":"completing tutorial, switch Galaxy server \nuse throughout course available :\nhttps://galaxy.bioinf.nl contains collection course specific\ntools.Galaxy server\nhost different one ’ve used \ntutorial. Different sense means containing different\ncollection available software tools. tools \nusing course can found using search tools input field, can found top left corner Galaxy.tools however installed bundles category\ntherefore easiest method finding tool need \nsimply enter name search tools field top-left\ncorner.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"data-and-quality-control","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.2 data and quality control","text":"project “simulated” patient data single patient\nsuspected disease investigating. patient data\nconsists next-generation Illumina MiSeq reads captured exomes\npanel given size (small number genes). example, \nlooking gene panel used diagnose hearth disease\ncardiomyopathy sequence data available “” 55 genes \n26k genes. (CARDIO panel, see table \nNCBI\nproduct page - note lists 51 ) likely\ninvolved disease. total length captured exomes \n55 genes 320,000 bases. , just small\nfraction complete exome lenght.","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"fastq-format","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.3 FASTQ format","text":"mentioned , great portion data produced \ncomputational biology called Next-Generation Sequencers.\nmachines read DNA RNA material write sequences \nfile (different machines techniques used create data\npresented class).file format often find \nFASTQ format. can\nrecognize file ’s extention .fastq .fq. FASTQ\nfile simple text file read bases together \npredicted quality stored.find two (shortened) reads coming Illumina\nnext-generation sequencer. Keep mind typical run NGS\nmachine millions short sequences! theoretical\nmaximum number reads given size determined underlying\ntechnique used, greatly differs different techniques.Read 1:(M01785:20:000000000-A3F6F:1:1101:16810:1655?)\n1:N:0:2\nNTCATGTACGGTCAGGATGGACGCACTCAACATTTTCAAGTTATTACTCCTTCAACTCAAAACTCCAGAAGTACACTAAATCATATATGTTGTTTTCT\n…+\n#>>1A1B3B11BAEFFBECA0B000EEGFCGBFGGHH2DEGGHGFFFGFFHHFGBGEFFFFFGGEGBF1BCFFE2BGFHBGHGHFF2FFFGHHHHHH\n…Read 2:\n(M01785:20:000000000-A3F6F:1:1101:12839:1664?)\n1:N:0:2 \nTATATCTATGTCATTTTTTTCTCAATAATACTAAGAGAAAGAAGGCAACTCAAGGATCCTATTAATCCTTTAGAATTTCTACTTAAATCTCACATCCATTA\n…+\n1>1AFFFD3DDDGGGGGGGGGHF3FDFGFHHFB1110FF10000FGGGHHDC110FEGGBGHFFHFHHHHGBFHHHHHHHHHGHHFFHHHHHHH\n…read constists :\nfirst line describing machine run , \nchip identifier actual coordinates chip base\nread\nfirst line describing machine run , \nchip identifier actual coordinates chip base\nread\nactual read sequence\nactual read sequence\nplus sign\nplus sign\npredicted read base quality ASCII value\npredicted read base quality ASCII valueThe difference widely known\nFASTA format mainly \naddition Quality line (green). given \nquality-characters, determine sequences \ngood sequences? character quality line corresponds \nnumerical quality\nscore, can\nlooked called ASCII tables.Note: can think intermediate ASCII table used \ncalculate quality scores?Lets take closer look first sequence . first 10\nbases : NTCATGTACG quality scores bases :\n#>>1A1B3B1. can now look quality characters ASCII\ntable.look example \nfirst character #, find value 35 ASCII table. \nIllumina reads subtract 33 (called offset, \ndifferent techniques may use different offset) value. \nend : 35 - 33 = 2. score first base N 2.\nscore called Phred score. Lets also look Phred\nscore second base T ASCII character >. >\ncharacter translates value 62. subtract 33 \nvalue calculate Phred score. 62 - 33 = 29.Phred quality score really mean? score indicates \nprobability base call erroneous. quality score Q \nlogarithmically related probability incorrect base call:\n\\[ Q = log10P \\] \\[ P = 10^{(-Q/10)} \\]. calculate probability\nfirst base incorrectly called, can calculate like\n: \\[ Q = 2 \\rightarrow P = 10^{(-2/10)} \\rightarrow P = 0,63 \\]equates 63%. can also look probability \nfirst base correct, subtract number 1. \nprobability first base correct : 1 - 0,63 = 0,37 \n37%. probability second base correctly called : \\[ 1 -\n(10^{-29/10}) = 0,9987 \\] 99,87% accuracy. general can say\nPhred-score 30 acceptable (99,9% accuracy) \nfirst two bases fail get.Complete table .\nBase\n\nN\n\nT\n\nC\n\n\n\nT\n\nG\n\nT\n\n\n\nC\n\nG\n\nQuality char\n\n#\n\n>\n\n>\n\n1\n\n\n\n1\n\nB\n\n3\n\nB\n\n1\n\nNumerical score ASCII value - 33\n\n2\n\n29\n\nBase call accuracy 1 - P\n\n37%\n\n99,87%\n","code":""},{"path":"intro-ngs-and-genetics-project.html","id":"quality-control","chapter":"Week 1 Intro NGS and Genetics Project","heading":"1.6.4 Quality Control","text":"need load patient data going work \nproject. patient data already server first need\nload Galaxy History work . \nfirst go Shared Data menu click \nData LibrariesOpen patientData library. find sequence data\ndifferent cases, named disease TODO: new screenshot depicting cases. can see case\nconsists two files. forward reverse reads \nsplit two files (paired-end sequencing). files R1\nname forward reads reverse reads R2 \nname, remember tools require select proper\nfile.example Alzheimer disease case, can select \nread files Alzheimer. Check boxes R1 R2 Sample1\nclick Download button top, chose file\nextension (doesn’t matter) starts download. Next, open \nLinux file browser navigate Downloads folder. Extract \ndownloaded archive file resulting two new archived files (\n.fastq.gz format means files compressed using gzip).\nGalaxy, create new history open default one \nTools menu click Get Data Upload File links. Either\ndrag select SampleX_xxxxx.fastq.gz files get ready \nupload don’t upload just yet.Galaxy automatically tries detect file format add\nhistory, often using ’s file extension. case, \nneed make sure Galaxy proper format selected \nfastqsanger. Sanger part format refers phred\nquality scoring method used file exist multiple scoring\nmethods. Without correct data type tool FastQC (see\n) doesn’t know read sufficient quality worse,\nqualifies reads incorrectly. Select proper type drop-\nmenu upload files.uploaded sequence data history \navailable work . went correct, now see two\nsequence files History Galaxy.start analyse NGS data important get feeling\ndata. data look like? quality \ndata? (although can) want draw conclusions low\nquality data. common errors data can corrected. able , \nfirst need identify wrong data. look \nmany (quality) aspects imported datasets, going start \ntool named\nFastQC.\nTools panel, open Diagnostic Genome\nAnalysis category click FastQC\ntool. settings FastQC tool appear middle\nsection. help usually shown open tool well \nscientific literature associated tool references.\nFastQC tool can load short read data history. Also \ncontaminant list can uploaded (example primers pre-process\nstep can sometimes end data give sort problems\ndownstream). submodule part FastQC setting can specify\nsubparts tools need run. now going \nbother settings short read data.Select Multiple Datasets Short read\ndata current history press\nExecute.clicked Execute, jobs started added \nHistory. item history number increments one\nnew item. jobs finished appear green. jobs finished, four\nnew items appeared History. look closely, can see\nFastQC run data 1 2 History. FastQC \ngenerated two types reports: RawData \nWebpage. look Webpages \nshort read datasets. Click View Data (eye-icon) \nwebpage output data 1In middle panel webpage results data 1 open.\nsummary quality checks performed visable gives \nquick overview checks need attention.Report total number sequences analysed, number \nsequences flagged poor quality, sequence length GC\npercentage. Next, look per base sequence quality,\nplot sequence position plotted x-axis base\nquality plotted y-axis. bar plot represents \ndistribution sequences analysed dataset \nposition. Also look Webpage data 2 compare plots. \nsee differences plots use dataset\nanalysis?information box plot, please look :\nhttps://en.wikipedia.org/wiki/Box_plotNow took first look data quality, \nmodify data make sure get data highest quality \nperform analysis . likely current data contains (many)\nreads low quality short performing next\nsteps. following two chapters finalize look \ndata quality performing read trimming remove\nreads (parts reads) low quality. data\nset acceptable quality perform next important\nanalysis step; read mapping (week 2), visualize \nresulting mapping perform pileup operation (week 3.can see FastQC report, read quality drops end\nreads (normal Illumina protocol \nspecific sequencing technology used!).\nCan find happening?Also spread quality positions may greater \nlike see. next step going remove reads \nlow quality just short used. make DNA\navailable sequenced, primers annealed DNA. \nprimers also removed.Tools menu select \nTrimmomatic\ntool.Check paired end data selected.Select Pair Datasets Input Type (default) select patient R1 \nR2 files.Perform initial IlluminaCLIP step select \nTruSeq3 (paired-ended, miSeq HiSeq) adapters.Trimmomatic operation select Sliding window trimming choose 4\nbases average across, quality 20 (minimum).Click plus sign (Insert Trimmomatic Operation button) \nSelect Drop reads specified length Set minimum read\nlength 70 (can think reason want many short reads?)Execute tool.Trimmomatic give 4 new files output, read help \nTrimmomatic tool (can found tool settings Galaxy) \nunderstand file contains. next steps analysis \nimportant forward reverse reads order\nfiles. reason one forward reverse reads \nremoved one files, two files order \n. reason Trimmomatic remove reads files.\none read threshold removed, ’s paired partner\nwritten unpaired output file (\nthreshold). output find 4 files: one forward\npaired one reverse paired (still order) one\nunpaired forward one unpaired reverse. Rename \ntwo files use next step something like\nTrimmed Reads [ID] R1 00X etc.Report number reads removed \ndataset.\nCreate new FastQC plots Per Base Sequence Quality (\ncleaned, paired data).\nCompare plots original uncleaned data report \ndifferences.\nCreate new FastQC plots Per Base Sequence Quality (\ncleaned, paired data).Compare plots original uncleaned data report \ndifferences.Perform multiple FASTQ cleaning runs (time original\ndata!).\nChange setting report number reads removed.\nCreate save Per Base Sequence Quality plots \nrun.\nReport (table instance) effect \nsetting Trimmomatic tool.\nPick best (combination ) settings copy R1 R2\ntrimmed datasets new history Galaxy, data \nused next analysis step.\nPlease remove unused output Trimmomatic previous\nhistory, might take gigabytes space. \ndelete files (can also ‘undeleted’) just\nmarked actual deletion months.\nChange setting report number reads removed.Create save Per Base Sequence Quality plots \nrun.Report (table instance) effect \nsetting Trimmomatic tool.Pick best (combination ) settings copy R1 R2\ntrimmed datasets new history Galaxy, data \nused next analysis step.Please remove unused output Trimmomatic previous\nhistory, might take gigabytes space. \ndelete files (can also ‘undeleted’) just\nmarked actual deletion months.","code":"Note for FireFox users:\n\nAt some point you might see an error page when *viewing* the contents of\na file in Galaxy (by clicking on the `eye`-icon in the history. This\nerror can be fixed by changing one of the security settings of your\nbrowser. You can do this by typing <strong><about:config><\/strong> in\nthe url bar. In the options you are presented with, search for:\n<strong>network.http.accept-encoding<\/strong>. Right click and select\n<strong>Modify<\/strong>. Remove the text that is there and change it to\n<strong>\\*<\/strong>. If you don't see this error there is no need for\nchanging this setting.\n\nEvery time a dataset is loaded into the *history* panel (from a manual\naction, like we just did or from the output of a tool), you can have a\nquick look by clicking on the name of the dataset. In this case it will\nshow you the first read (and a bit..) of the loaded library. A couple of\nactions can be taken on each item in your History such as *View Data,\nEdit Attributes* and *Delete*. When you click on the name of an item in\nthe History additional actions such as downloading the data, viewing the\nGalaxy (job) background information or visualising the data appear. Go\nahead poke the `eye`-button now and have a look at the raw data"},{"path":"read-mapping.html","id":"read-mapping","chapter":"Week 2 Read Mapping","heading":"Week 2 Read Mapping","text":"Now know quality NGS patient data corrected reads low quality short read lengths, can continue mapping reads reference genome. step use human genome reference map cleaned reads using tool BWA. mapping reads can look variations reference patient.","code":""},{"path":"read-mapping.html","id":"mapping-with-bwa","chapter":"Week 2 Read Mapping","heading":"2.1 Mapping with BWA","text":"starting mapping data human reference genome, can calculate important statistics see can achieve data.","code":""},{"path":"read-mapping.html","id":"assignment-week-2","chapter":"Week 2 Read Mapping","heading":"2.2 Assignment week 2","text":"\nminimal average coverage (read depth) 20,\n\nread length 2 * 150 (read pair read 150 bases),\n\nhuman genome size 3,137,161,264 bases \n\ntarget region (captured region, size gene panel) totals 320,000 bases Cardio panel. differs chosen case calculated .\n\nC coverage,\n\nL read length \n\nN number reads\ncleaned dataset, look many reads left mapping. Calculate expected coverage use data gene panel (G = captured region). Illumina MiSeq V3 can produce 25 million reads length 300, many patients analyse per run minimum coverage 20 using gene panel? Calculate assignments R within document.Select Map BWA-MEM tool Tools menu. mapping using built-genome (made human genome available Galaxy). Select Human reference HG19 reference genome setting. Select paired end reads.previous experiments different FASTQ cleaning settings, select R1 paired Trimmomatic data first set reads R2 paired Trimmomatic second set reads. Execute tool, take run (10 - 20 minutes).","code":""},{"path":"read-mapping.html","id":"marking-duplicate-mapped-reads","chapter":"Week 2 Read Mapping","heading":"2.3 Marking Duplicate Mapped Reads","text":"process creating reads, duplicates may arisen PCR artifacts. duplicate reads real biological sequences sense originate sample, technical artifact. downstream analysis duplicate reads may generate false positive variants. Can think reason case?going look differences reference patient, first mark duplicate mapped reads. , select MarkDuplicates tool Tools menu. Select Map BWA-MEM output data … …., set Assume input file already sorted option Execute tool. tool add flag read finds duplicate tools ignore read flag. therefore remove read data.","code":""},{"path":"read-mapping.html","id":"visualizing-the-mapping-data","chapter":"Week 2 Read Mapping","heading":"2.4 Visualizing the Mapping Data","text":"going look actual mapping get bit feel happend till now. look mapping output previous step - marked duplicates - Genome Browser.system Integrated Genome Viewer (IGV) installed. First need download mapping data computer. , download dataset bam_index files markduplicates output Galaxy shown .Select Save File pop window.Open IGV either going (Linux)  Applications Menu -> Run Program… type igv click launch opening terminal entering igv command. Next, can load mapping data IGV clicking File -> load File…. Look Downloads folder file name starting Galaxy ending .bam (need open BAM file, index file automatically loaded).sequence reads captured exomes (totaling 320.000 bases example Cardio panel, just 0,001% total genome), zoom quite bit see mappings. help find zoom , can add extra layer genome browser (called track). uploaded files containing exome regions genepanel galaxy server. can download file case going Shared Data -> Data Libraries -> case_name Galaxy browser. Select case_name.BED click History button. replace case_name actual case. Please look file History. file consists 4 columns, describe chromosome number, start location exome, end location exome gene name. Download file (Save File) computer.Now IGV, select File -> Load File... Look Downloads folders file ending .bed open file. screen look like now:4th column bed file, choose couple gene names. take SOD2 example (SOD2 lays chr6 5 exomes part Cardio gene panel).IGV type name selected gene search box click Go.screen load mapping results region includes example SOD2 gene.\ncouple regions important genome browser screen. top row shows location looking now.middle row actual mapping data. first row shows coverage plot. can hover plot mouse. show many reads mapped position nucloetide distribution position. Also number forward reverse reads shown. case position 328 reads mapped. also tells us 100% reads G position (157 forward mapped reads 171 reverse mapped reads)middle row shows mapped reads. mapped paired-end reads make visible IGV, right click mapping track select View pairs. Reads colored according read orientation insert size. Look IGV online manual explaination colors.Zoom gene interest. Regions reads grey color indicate simular region reference. Variants shown colored vertical bars (nucleotide color). Zoom till nucleotide sequence showing variant. example looking T variant patient position. see total 117 reads mapped position reads 64 T 53 position. patient heterozygous allele. Can see variant exon ?, consequences variant exon location? Look variant exon. bottom row show translation DNA protein. found variant causes change (non-synonymous) aminoacid sequence (synonymous)?Look reads end exon. cardiopanel captured exons + 20 bases 55 genes. reads outside location?following steps answer following questions gene: many variants found?, many exons? many variants actually cause aminoacid sequence change? IGV uses naive variant calling method result many false positives. going use sophisticated method downstream steps.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"analysis-of-cardiopanel-variants","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"Week 3 Analysis of Cardiopanel Variants","text":"done mapping reads reference genome, can determine variant positions within genes interest. use Galaxy tool called LoFreq report found variants statistics allele frequency, number supported reads, average base quality found position, etc.finding actual variants, perform analysis assessing achieved coverage. might seen IGV, coverages range high numbers (300+) places reads present. chapter use R number libraries often used genetics research report numbers cardiopanel genes.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-week-3","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1 Assignment week 3","text":"","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"programming-assignments-coverage-overview-for-cardiopanel-genes","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.1 Programming Assignments; Coverage Overview for Cardiopanel Genes","text":"Within output previous mapping step (BAM file) can see (well) \npanel-genes covered reads, important statistic \nquality data. assess manually using IGV, definitely method use task even though ‘’ 50 genes total. section contains number small assignments - completed - give us clear indication whether mapping sufficient quality. Depending outcome might need revisit previous step(s) trimming process increase mapping quality.assignments gain insight coverage genes interest well variants. use BED-file describing locations exons, BAM file containing mapped reads - ’ll create later - VCF-file listing found variants. number assignments asks visualize results get good understanding ’re looking .","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-instructions","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.2 Assignment Instructions","text":"number assignments together perform tasks \nexplained . required carefully read \ninstructions make sure understand goal data used \nparticular assignment. able critically reflect \noutcome analysis important aspect \nbioinformatician! Furthermore, assignments generally \nguideline considered minimum tasks \ncomplete, always invited data \n. Feel free explore keep code lab-journal \nwell.perform tasks need learn theory \nspecific working data (BED Pileup files among others).\nintroduce Bioconductor libraries later . First\nthough explore simple data files create \nsimple plots based BED data.assignments, create least one code-chunk, name \naccordingly assignments reflect . \ninstance end product assignment one dataframe \nproper header overview plot number exons per\nchromosome, end assignment stating “loading processing data, overview shows chromosomes exons located opanel genes”.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-1-loading-the-bed-data","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.3 Assignment 1; Loading the BED-data","text":"first step program read BED file get exon\nlocations opanel genes. already viewed contents \nBED file Galaxy, saw file contains 4 columns:chromosome number,exon start location,exon end location thegene nameFor example:Perform tasks:Load BED-data\nSince data stored text file using tabs column\nseparators, can easily read using read.table\nfunction.\nSince data stored text file using tabs column\nseparators, can easily read using read.table\nfunction.Change column names\ncolumn names BED-file read.table gives\ndefault names case: [1] \"V1\" \"V2\" \"V3\" \"V4\". Using \nnames function, can assign new column names, \nassigning vector four column names (see help \nnames)\ncolumn names BED-file read.table gives\ndefault names case: [1] \"V1\" \"V2\" \"V3\" \"V4\". Using \nnames function, can assign new column names, \nassigning vector four column names (see help \nnames)Print number exons per chromosome\neasy way get overview large amounts data (\n1204 exons case) using table function. Using\nfunction, show number exons per chromosome.\neasy way get overview large amounts data (\n1204 exons case) using table function. Using\nfunction, show number exons per chromosome.Plot number exons per chromosome\ndata (3) can used create plot giving \nbarplot function. Change label y-axis \nsomething meaningful. Since chromosome numbers can’t fit\nx-axis can change orientation using las = 2\nargument barplot. options aren’t necessary \nplot doesn’t pretty stage.\ndata (3) can used create plot giving \nbarplot function. Change label y-axis \nsomething meaningful. Since chromosome numbers can’t fit\nx-axis can change orientation using las = 2\nargument barplot. options aren’t necessary \nplot doesn’t pretty stage.","code":"10  75399683    75399795    MYOZ1   \n10  75757946    75758153    VCL   \n10  75802821    75802931    VCL"},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-2-bed-visualization","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.4 Assignment 2; BED-visualization","text":"Visualize number genes per chromosome\nrequires creation subset unique chromosome-gene\ncombinations; genes consist exons reduce \ngenes single exon (doesn’t matter ), can use\ntable function give us numbers need.\nSelect ‘chromosome’ ‘gene’ columns (using names\ngave assignment 1.2) BED-data\nApply unique function reduce data single row\nper gene store ‘chromosome’ column result\nGive data table use result input \nbarplot function using proper label y-axis.\nrequires creation subset unique chromosome-gene\ncombinations; genes consist exons reduce \ngenes single exon (doesn’t matter ), can use\ntable function give us numbers need.Select ‘chromosome’ ‘gene’ columns (using names\ngave assignment 1.2) BED-dataApply unique function reduce data single row\nper gene store ‘chromosome’ column resultGive data table use result input \nbarplot function using proper label y-axis.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-3-bioconductor","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.5 Assignment 3; Bioconductor","text":"software developers develop algorithms solutions common\nproblems, like publish code others can use\n. R (many programming languages) code \npackaged library can easily distributed others.\nmight already familiar library() function R load\nexternal code environment \n.Bioconductor repository contains\n1800 libraries can get R use perform\nanalysis . vast amount libraries focused \nanalyzing, processing visualizing (high-throughput) biological data\nalso using practical courses. Luckily \ndon’t find libraries assignments \nalways instruct one use (load actually, since \npre-installed network).introduce concept required \nremaining assignments , namely GenomicRanges objects\n(website,\nmanual),\nconsisting IRanges\n(website,\nmanual)\nobjects. ‘objects’ (hold data combination vectors,\nlists data frames among data structures) used store\ninformation features genome. features (introns,\nexons, variants, etc.) always defined coordinates \nstart stop positions name sequence (case,\nchromosome) lie.BED-file instance can represented using\nIRanges since contain simple positional data (chromosome\nposition (start/ stop BED-data). Let’s first see example representing exons BED file IRanges objects (don’t need replicate \nexample).Shown dataframe similar data containing five\nexons SOD2 gene located chromosome 6. exon \nbegin end coordinate. data can converted IRanges \nusing similar named function providing correct columns \nshown :see data now represented IRanges object. however miss data (chromosome) get extra data well (width (length) exon). ’s important know chromosome gene lies convert ranges object GRanges object combines data:comparing IRanges object GRanges object, looks rather similar yet missing data (width) extra data (strand). Nothing lost though, objects often lot accessor methods can use getting actual data, example representation object get print . Functions width() applied IRanges object gives width column ranges() function applied GRanges object gives IRanges object contained within. needed, assignments hint usage linked manuals also describe important ones.Now gene within GRanges object, can ? now just BED data lot, also put Pileup data similar GRanges object, can start asking data interesting questions pileup function instance. can used get Pileup information specific exons ignoring everything else. can need get BED-data proper format first now.challenging assignment results yet another type object, named GRangesList contains multiple GRanges objects; one gene shown example. , order need :Create empty (standard) R list,Iterate genes BED file,\nRead part iteration \nhints split function get gene names data easily accessible.\nRead part iteration andthe hints split function get gene names data easily accessible.gene, create GRanges object add list, including gene name (use following form: my_list[[gene_name]] <- data) andConvert complete list GRangesList object.\nUse conversion explained GRanges manual: bed_data <- GRangesList(bed_data) given list called bed_data.\nUse conversion explained GRanges manual: bed_data <- GRangesList(bed_data) given list called bed_data.techniques required assignment mainly knowing work lists (including create , accessing single elements, adding lists iterating items). following hints, numbered list examples everything need assignment. bit code show expected result can repeat data check.Hints instructions:IterationWhen talk iterating performing programming, mean repeatedly performing set operations separate elements (vector, list, columns rows data-frame, etc.). ordinary programming languages often requires explicit step-wise execution operations, using constructs ‘loops’. R however, already perform lot iterative steps without realizing . Given vector x, can multiply value simply stating x * x. Programming languages Python, Java C require code like:still pretty readable code, R never require explicit form even though . simple one liner R instance calculates average log2 ratio two columns data-frame can contain thousands rows many columns, :require rather large -loop languages. want apply something element separately R often use - rather complicated efficient - apply functions. now though use easier understand loop perform code data gene (point 1 ). following example iterating bed_data able perform assignment:HintsAs point 2 asks iterate genes, need think way group data (exons) genes can done using split function. result split list 55 named elements; one gene.\nsplit function requires two arguments: first data-frame containing data second argument column containing gene names (.e. bed_file$gene)\ncan get gene names executing names function resulting list split.\ncan get exon-rows easily accessing list items: split_output[[gene_name]].\nsplit function requires two arguments: first data-frame containing data second argument column containing gene names (.e. bed_file$gene)can get gene names executing names function resulting list split.can get exon-rows easily accessing list items: split_output[[gene_name]].iterating, code execute gene (1) create IRanges object, (2) create GRanges object combining chromosome IRanges object finally appending list.completed, run following code - besides load function - compare results. Also, likely challenging assignment re-use parts code made now. Revisit everything ’ve written complete task make sure understand everything (exact works less importance).","code":"\n## Only needed when the package is missing\nif (!require(\"BiocManager\"))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"GenomicRanges\")\n# This package contains the 'IRanges', 'GRanges' and 'GRangesList' classes we will use\nlibrary(GenomicRanges)\n# Loading the BED data (note: use your own data from assignment 1)\nload(\"data/bed_data.RData\")\n# Print all rows where the gene name is for example 'SOD2'\nbed_file[bed_file$gene == \"SOD2\", ]##     chromosome     begin       end gene\n## 649          6 160103505 160103690 SOD2\n## 650          6 160105866 160106085 SOD2\n## 651          6 160109138 160109294 SOD2\n## 652          6 160113673 160113915 SOD2\n## 653          6 160114157 160114219 SOD2\n# Get the data as a subset of the cardiopanel data\nsod2 <- bed_file[bed_file$gene == \"SOD2\", ]\n\n# Assign whole columns to the IRanges arguments\nranges <- IRanges(start = sod2$begin,\n                  end = sod2$end,\n                  names = sod2$gene)\n# Print the object\nranges## IRanges object with 5 ranges and 0 metadata columns:\n##            start       end     width\n##        <integer> <integer> <integer>\n##   SOD2 160103505 160103690       186\n##   SOD2 160105866 160106085       220\n##   SOD2 160109138 160109294       157\n##   SOD2 160113673 160113915       243\n##   SOD2 160114157 160114219        63\n# Calculate and print the length of a gene\ncat(\"Length of SOD2:\", sum( width(ranges) ), \"bp\")## Length of SOD2: 869 bp\n# Converts to GRanges and adds the text 'chr' to each chromosome\ngranges <- GRanges(seqnames = paste0(\"chr\", sod2$chromosome),\n                   ranges = ranges)\ngranges## GRanges object with 5 ranges and 0 metadata columns:\n##        seqnames              ranges strand\n##           <Rle>           <IRanges>  <Rle>\n##   SOD2     chr6 160103505-160103690      *\n##   SOD2     chr6 160105866-160106085      *\n##   SOD2     chr6 160109138-160109294      *\n##   SOD2     chr6 160113673-160113915      *\n##   SOD2     chr6 160114157-160114219      *\n##   -------\n##   seqinfo: 1 sequence from an unspecified genome; no seqlengthssquared = []\nfor value in x:\n    squared.append(value * value)mean(log2(dat['sample1], dat['sample2']))\n# Load the stored data; do not repeat. Object name in this\n# example is 'bed_data' \nload('data/bed_data_GRangesList.RData')\n\n# Split the data by gene, resulting in a list with named elements\nbed_splitted <- split(bed_file, bed_file$gene)\n# Print the names of the first 10 genes\nfor (gene in names(bed_splitted)[1:10]) {\n    print(gene)\n}## [1] \"ABCC9\"\n## [1] \"ACTC1\"\n## [1] \"ACTN2\"\n## [1] \"ANKRD1\"\n## [1] \"BAG3\"\n## [1] \"CALR3\"\n## [1] \"CAV3\"\n## [1] \"CRYAB\"\n## [1] \"CSRP3\"\n## [1] \"DES\""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-4-gene-lengths","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.6 Assignment 4; Gene Lengths","text":"’ll create one last visualization based BED-data - now using GRanges object - namely overview gene lengths; another barplot. example code shows calculate length single gene (using ranges, width sum). code also works complete GRangesList object, use create barplot showing length gene.Hint:notice, one gene long compared others makes plot difficult read. plotrix library contains gap.barplot function specifically purpose (also supports las = 2 argument). Try use function creating barplot. small challenge can try style y-axis show values (‘ticks’) besides minimum maximum.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-5-loading-the-mapped-reads","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.7 Assignment 5; Loading the Mapped Reads","text":"R use output mapping step (BAM file) inspect coverage mapped positions panel genes. R library can read data (RSamtools website manual) GRanges objects. already downloaded data input IGV tool previous chapter.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"rsamtools","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.8 Rsamtools","text":", briefly introduce library able use . Rsamtools described “interface BAM files”, file contains mapping information.Functions Rsamtools use - order - :BamFile: Reference BAM data index (.bam.bai)ScanBamParam: Sets parameters selecting certain region genome using GRanges (.e., gene BED-data)pileup: Actually retrieves region interest given BamFile parameters supplied.Assignment:Load BAM mapping data list data-frames covering mapped positions interest","code":"\n# Installing required library\nBiocManager::install(\"Rsamtools\")\n\n# Loading the RSamtools library\nlibrary(Rsamtools)"},{"path":"analysis-of-cardiopanel-variants.html","id":"instructions","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.1.8.1 Instructions","text":"Create BamFile object providing file index parametersCreate BamFile object providing file index parametersCreate ScanBamParam object\ndefining ranges want get mapping, case ranges exons gene\nselecting single gene GRangesList object (using [[\"geneName\"]] syntax) store object (’s type GRanges)\nGive GRanges object ScanBamParam function store variable\nCreate ScanBamParam objectWhat defining ranges want get mapping, case ranges exons geneDo selecting single gene GRangesList object (using [[\"geneName\"]] syntax) store object (’s type GRanges)Give GRanges object ScanBamParam function store variableGet actual mapping data region interest\nCall pileup function providing - order - objects created points 1-2. Note need tell pileup parameter , use pileup(file = ..., scanBamParam = ...)\noutput pileup function data-frame, store result\nPrint first lines data-frame (use head function)\nGet actual mapping data region interestCall pileup function providing - order - objects created points 1-2. Note need tell pileup parameter , use pileup(file = ..., scanBamParam = ...)output pileup function data-frame, store resultPrint first lines data-frame (use head function)mention pileup assignment means looking single genomic position like ’ve seen IGV. tools available generate pileup file BAM file (file format description available\n\n) containing following information mapped positions:chromosome name (1)reference position (2),reference base (3),number supporting reads (4),match (5), either:\ndot match forward strand \ncomma match reverse strand\nnucleotide case mismatch (upper case forward\nstrand, lower case reverse strand)\ninsertions/ deletions (defined + - sign followed \nnumber defining size insert/ deletion, followed \nbases form insert/ deletion).\ndot match forward strand ora comma match reverse stranda nucleotide case mismatch (upper case forward\nstrand, lower case reverse strand)insertions/ deletions (defined + - sign followed \nnumber defining size insert/ deletion, followed \nbases form insert/ deletion).quality [6] (taken FASTQ file) can seen last\ncolumn, one value readThe reason format called pileup position\npile (stack) data mapped reads \nposition. first example line (chromosome 1, position 10004)\none read match (reference C shown \ncolumn 3) reverse strand second line three supporting\nreads match.line example multiple reads (30 total, shown\ncolumn 4 lengths columns 5 6) mapped single\nposition. chromosome 1 see column 5 \nsomething going . Read 8 contained C whereas reference (\n29 reads) show T position, classified\nmismatch subject analysis steps.Besides mismatches, can also insertions deletions \nshown example - sign followed number \nnumber bases missing.Look data get position note - least - two rows data per position; one strand (’ve also seen IGV). two rows data single position, might variant coincidentally demonstrated example data :first position SOD2 gene case shows three rows; two positive strand one negative strand. count column shows single read T nucleotide position instead C 297 reads show. big difference, can attributed sequencing error.Note though now summary actual pileup compared detailed line see actual Pileup file within Galaxy. data also available using RSamtools require summary.","code":"  1          2   3    4   5     6\nchr1     10004   c    1   ,     [ \nchr1     10005   g    3   ,,.   ?1>chr1    16888646    T   30  .......C........,.,.....,,....  WomHHGomooHmHFHHGGFH1GDHHHHGFFchr1    16888710    a   31  ..,.,..,..,,-2ct,,..,.,,.-2CT,,.,,.,.,, nGFkGUlFF?DFHFGGEnHFFHHGFHG5GGB\n# Load the example Pileup data for the SOD2 gene (do not repeat)\nload(\"data/sod2_pileup.RData\")\nhead(sod2, n = 5)##   seqnames       pos strand nucleotide count              which_label\n## 1     chr6 160103505      +          C   221 chr6:160103505-160103690\n## 2     chr6 160103505      -          C    77 chr6:160103505-160103690\n## 3     chr6 160103505      +          T     1 chr6:160103505-160103690\n## 4     chr6 160103506      +          T   220 chr6:160103505-160103690\n## 5     chr6 160103506      -          T    77 chr6:160103505-160103690"},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-6-pileup-processing","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.2 Assignment 6; Pileup Processing","text":"assignment get pileup data genes single object can report average coverage gene determine positions low coverage might need inspect, later.Steps need taken:Create empty list (hold separate data-frame gene created assignment 5)Iterate BED-data (GRangesList object) similar assignment 3Get pileup data gene -loop, creating ScanBamParam executing pileup functionAdd resulting pileup data-frame list, using ’s gene name identifier (pileup_list[[gene_name]] <- ...)Check printing head gene used assignment 5","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-7-coverage-calculation-and-reporting","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.3 Assignment 7; Coverage calculation and reporting","text":"Calculating actual coverage position little cumbersome need sum count rows single position since don’t - yet - care mismatches strand read mapped .Instead performing kinds programming steps check positions similar , summing count values, can use R function us. don’t expect understand following example besides understanding produces. summation can done function called aggregate, defined “Compute Summary Statistics Data Subsets”.Given column group (pos column) perform function different column (count column containing coverage. result aggregate two-column data-frame position sum count values position; total coverage.provide arguments follows:x: count column (provide list gets name resulting data-frame well): pos column grouping applied toFUN: function perform grouped rows (case, sum function)Use code check rename used variables suit data.task now calculate per-position coverage genes calculate report - gene:number bases sequenced gene,average coverage gene andthe number low-coverage positions (coverage < 30) number calculated percentage.Given tasks code previous assignments, able . Store calculated values (4 values) combined gene name new data-frame show completely lab-journal, ordered percentage low-coverage positions, descending.following code can used create empty data-frame add rows data. Note isn’t done often, use forget. first line code (options function) needed stop annoying R behaviour.","code":"\ncoverage = aggregate(x = list(count=sod2$count), \n                     by = list(pos=sod2$pos), FUN=sum)\nhead(coverage)##         pos count\n## 1 160103505   299\n## 2 160103506   297\n## 3 160103507   297\n## 4 160103508   291\n## 5 160103509   292\n## 6 160103510   290\n# Tell R not to complain...\noptions(stringsAsFactors = FALSE)\n\n# Create empty data-frame, but specify columns and data types\ndf <- data.frame(Name=character(), Course=character(), Grade=numeric())\n\n# Create a new row of data, stored as a named list (important)\nnew_row = list(Name=\"James\", Course=\"Math\", Grade=7.5)\n\n# Append data to the data-frame using rbind\ndf <- rbind(df, new_row)\n\n# Or within a single line\ndf <- rbind(df, list(Name=\"Wendy\", Course=\"Math\", Grade=8))\n\n# print\ndf##    Name Course Grade\n## 1 James   Math   7.5\n## 2 Wendy   Math   8.0"},{"path":"analysis-of-cardiopanel-variants.html","id":"hints","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.3.1 Hints","text":"assignments using iteration, create data-frame outside -loop perform rbind within -loop.Take good look (print testing) iterating ; case list containing data-frames.need re-use aggregate code adjust make sure uses data get iterationStore calculated value variable within -loop check (print) mistakes easily made.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"end-result","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.3.2 End Result","text":"example data might get completed assignment. Note values well column names different case.","code":"\n# Load example data\nload(\"data/statistics.RData\")\n\nstatistics##        length avg_coverage low_coverage low_coverage_perc\n## ABCC9    6348        249.2            0               0.0\n## ACTC1    1375        192.4           57               4.1\n## ACTN2    3527        184.5            0               0.0\n## ANKRD1   1322        232.4            0               0.0\n## BAG3     1892        207.7            0               0.0\n## CALR3    1511        242.5            0               0.0\n## CAV3      536        196.0            0               0.0\n## CRYAB     650        156.8            0               0.0\n## CSRP3     785        230.6            0               0.0\n## DES      1774        122.9          258              14.5\n## DMD     14643        248.7            0               0.0\n## DSC2     3424        237.9          109               3.2\n## DSG2     3959        239.1           86               2.2\n## DSP      9577        237.4            4               0.0\n## DTNA     3133        238.0            0               0.0\n## EMD      1006        169.9            0               0.0\n## EYA4     2683        251.9            0               0.0\n## GATAD1   1010        183.3          210              20.8\n## GLA      1570        237.6            0               0.0\n## JPH2     2292         88.7          699              30.5\n## JUP      2758         78.2          276              10.0\n## LAMA4    7193        236.0            0               0.0\n## LAMP2    1957        240.1            0               0.0\n## LDB3     3148        144.0           78               2.5\n## LMNA     2496         81.6          118               4.7\n## MYBPC3   5195        121.8          503               9.7\n## MYH6     7301        200.1           32               0.4\n## MYH7     7329        205.0            0               0.0\n## MYL2      781        211.4            1               0.1\n## MYL3      828        164.4            0               0.0\n## MYOZ1    1100        230.5            0               0.0\n## MYOZ2     995        252.1            0               0.0\n## MYPN     4723        243.7            0               0.0\n## NEXN     2511        247.7            0               0.0\n## PKP2     3206        207.9          263               8.2\n## PLN       199        233.8            0               0.0\n## PRKAG2   2350        183.2          349              14.9\n## PSEN1    1804        241.4            0               0.0\n## PSEN2    1747        150.2           56               3.2\n## RBM20    4243        215.7          230               5.4\n## RYR2    19104        246.3           88               0.5\n## SCN5A    6633        162.7          275               4.1\n## SGCD     1193        232.9            0               0.0\n## SOD2      869        184.4            6               0.7\n## TAZ      1400        168.5            0               0.0\n## TBX20    1664        193.4          167              10.0\n## TCAP      584         80.6            0               0.0\n## TMEM43   1683        179.5           52               3.1\n## TNNC1     726        175.0            0               0.0\n## TNNI3     953        105.2            0               0.0\n## TNNT2    1458        200.3           24               1.6\n## TPM1     1941        183.4          326              16.8\n## TTN    123059        250.0            0               0.0\n## TXNRD2   2241        132.8          116               5.2\n## VCL      4285        210.5           89               2.1"},{"path":"analysis-of-cardiopanel-variants.html","id":"finding-variants-using-lofreq","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.4 Finding Variants using LoFreq","text":"likely ’ve already seen true variant (single mismatches) looks looked data IGV-browser. variant see number reads different base positions compared reference genome. ’ve mentioned , interested variants patient data genes genepanel. previous visualize--data assignment ask find variants using IGV-browser section going use program us.tool use LoFreq tool scans BAM file variants. tool settings , combined, defines position called variant. naive way just report position change. result many false positive variants (can explain ?). need statistical approach filter low quality variants ’s tool settings instance set minimum amount reads (coverage) position consider looking variations. Also variants supported minimum number reads base quality position low.Instructions:Run Call variants LoFreq tool using default settings. Select output BAM file Mark Duplicate tool use available GRCh38 reference genome. Feel free explore options leave Call variants across settings Whole reference (setting allows using BED file selecting variants interest basically following assignment).","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"vcf-file-filtering","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.4.1 VCF File Filtering","text":"result LoFreq tool single new file history vcf file format line describes single variant. Galaxy can directly see many variants ; often well 1000 total. Note 17 comment-lines top file.looking file detail fairly easy see variants places interested . ’ve seen IGV, many regions sequenced outside genes interest, even far gene . LoFreq also checked regions variants assignment asks filter list variants keeping within exon boundaries genes interest. , another filtering step filtering actual variants. looking allele frequency value included VCF file. case, value describes percentage reads variant base.","code":""},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-8-vcf-file-processing","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.4.2 Assignment 8; VCF File Processing","text":"Please briefly read linked wikipedia page understand value importance. working patient data, use protocol described UMCG states variants minimum frequency 30% retained. means filter variants lower value. Note LoFreq stores value fraction filter values \\(>= 0.3\\).step--step instructions completing assignment. however possible without instructions partly repeat steps ’ve taken previous assignments.Read data data-frame using read.delim function\nMake sure data proper header (line 18 data)\nProvide stringsAsFactors = FALSE argument, otherwise next part won’t work (split R factor)\nMake sure data proper header (line 18 data)Provide stringsAsFactors = FALSE argument, otherwise next part won’t work (split R factor)Now data data-frame, inspect everything loaded correctly. first thing ’ll now get frequency value variant. Read comment lines VCF file see value stored. ’ll see columns contain fields, separated semicolon (;) can use split data get value want.Split column containing frequency value using strsplit functionThe output function list item vector separate items resulting split (inspect object RStudio). get frequency value list, R magic converts result strsplit matrix (found Stackoverflow):rbinds vectors matrix. , inspect object see actual value located want (use View function RStudio click name Environment tab).Write called one-liner (multiple statements single line code) :\nremoves AF= part using gsub function\nconverts data type column numeric\nsaves column new variable\nremoves AF= part using gsub functionconverts data type column numericsaves column new variableWe now frequency value available filtering ’ll adding GRanges object create next:Create GRanges object ’ve done assignment 3 simply creating IRanges object start end parameters get variant position column (POS column). Also provide seqnames parameter GRanges get contents chromosome column.GRanges objects can contain data well, called associated metadata. Using mcols function can see existing assign data variant. Adding data-frame allows us set name column demonstrated example previous chapter:Use example associate frequency value created GRanges object. Now BED-data (GRangesList object) VCF data GRanges object, canGet variants fall within exon\nUse findOverlaps function store output\nConvert output data-frame\nUse findOverlaps function store outputConvert output data-frameThe result findOverlaps contains two columns interested subjectHits column; rows VCF data lie within exon. can use column subset GRanges VCF object . Note queryHits column describes exons genes; meaning queryHit value 1 refers hit within ABCC9 gene exons.Filter remaining variants based frequency, using minimum 30%\nInstead removing rows creating another subset, make sure know rows kept filtering steps going reconstruct original VCF file (need Galaxy)\nManually sample rows see fall within exon frequency > 30%\nInstead removing rows creating another subset, make sure know rows kept filtering steps going reconstruct original VCF file (need Galaxy)Manually sample rows see fall within exon frequency > 30%Now row numbers variants want keep, need think way re-construct VCF file save disk.\nHint: read VCF file subsetting using readLines function\nNote: forget include 24 header lines!\nHint: read VCF file subsetting using readLines functionNote: forget include 24 header lines!Upload new VCF file Galaxy ’ll use next chapter.","code":"\nhead( do.call(rbind, bed_splitted), n=20)##           chromosome    begin      end  gene\n## ABCC9.814         12 21953958 21954135 ABCC9\n## ABCC9.815         12 21958088 21958265 ABCC9\n## ABCC9.816         12 21958912 21959014 ABCC9\n## ABCC9.817         12 21960260 21960433 ABCC9\n## ABCC9.818         12 21962766 21962909 ABCC9\n## ABCC9.819         12 21964963 21965111 ABCC9\n## ABCC9.820         12 21967558 21967676 ABCC9\n## ABCC9.821         12 21968677 21968847 ABCC9\n## ABCC9.822         12 21970101 21970261 ABCC9\n## ABCC9.823         12 21971064 21971205 ABCC9\n## ABCC9.824         12 21981872 21982014 ABCC9\n## ABCC9.825         12 21990992 21991124 ABCC9\n## ABCC9.826         12 21995228 21995425 ABCC9\n## ABCC9.827         12 21997397 21997506 ABCC9\n## ABCC9.828         12 21997681 21997869 ABCC9\n## ABCC9.829         12 21998517 21998786 ABCC9\n## ABCC9.830         12 22001064 22001200 ABCC9\n## ABCC9.831         12 22005011 22005176 ABCC9\n## ABCC9.832         12 22005282 22005459 ABCC9\n## ABCC9.833         12 22012500 22012620 ABCC9\n# Select and show data for a single gene (note that it specifies \"... and 0 metadata columns\")\n# ('granges' object is used from assignment 3)\ngranges## GRanges object with 5 ranges and 0 metadata columns:\n##        seqnames              ranges strand\n##           <Rle>           <IRanges>  <Rle>\n##   SOD2     chr6 160103505-160103690      *\n##   SOD2     chr6 160105866-160106085      *\n##   SOD2     chr6 160109138-160109294      *\n##   SOD2     chr6 160113673-160113915      *\n##   SOD2     chr6 160114157-160114219      *\n##   -------\n##   seqinfo: 1 sequence from an unspecified genome; no seqlengths\n# Generate some random values for 'allele frequency'\nallele_frequency <- round(rnorm(5, mean = 0.45, sd = 0.35), 1)\n\n# Bind this data to the 'GRanges' object\nmcols(granges) <- DataFrame(AF=allele_frequency)\n\ngranges## GRanges object with 5 ranges and 1 metadata column:\n##        seqnames              ranges strand |        AF\n##           <Rle>           <IRanges>  <Rle> | <numeric>\n##   SOD2     chr6 160103505-160103690      * |       0.5\n##   SOD2     chr6 160105866-160106085      * |       0.6\n##   SOD2     chr6 160109138-160109294      * |       0.1\n##   SOD2     chr6 160113673-160113915      * |       0.7\n##   SOD2     chr6 160114157-160114219      * |       0.8\n##   -------\n##   seqinfo: 1 sequence from an unspecified genome; no seqlengths"},{"path":"analysis-of-cardiopanel-variants.html","id":"assignment-9-variant-visualization","chapter":"Week 3 Analysis of Cardiopanel Variants","heading":"3.4.3 Assignment 9; Variant Visualization","text":"create two simple visualizations:Visualize allele frequency remaining variants using hist function. Remember can use mcols function get metadata column use $-sign name column. Pass argument breaks=20 hist answer following question lab-journal:\nCan explain two peaks see histogram (around 50% 100%)?\nCan explain two peaks see histogram (around 50% 100%)?Visualize amount variants per gene. simple solution getting numbers use table function queryHits column (output findOverlaps). Convert data frame use gene indices get actual gene names. Now combination gene number variants. Create barplot data previous chapter use cex.names=0.7 scale gene names make visible.","code":""},{"path":"variant-annotation.html","id":"variant-annotation","chapter":"Week 4 Variant Annotation","heading":"Week 4 Variant Annotation","text":"- now - final Galaxy workflow step analyzing patient, going annotate filtered variants determine severity variations determined last time LoFreq tool. involves comparing variants number databases containing annotation data known variants. use filtered VCF-file resulting LoFreq need upload newly created VCF file Galaxy. Make sure Galaxy recognizes file type selecting correct file type uploading change afterwards using Edit attributes button.","code":""},{"path":"variant-annotation.html","id":"snpeff-and-snpsift","chapter":"Week 4 Variant Annotation","heading":"4.1 SnpEff and SnpSift","text":"multiple methods annotating found variants. require extra data predict effect variant compare known set variants. use set tools types annotation. See details manual Github documentation.SnpEff: variant annotation effect prediction tool. annotates predicts effects genetic variants (amino acid changes)SnpSift: toolbox allows filter manipulate annotated files.\nactually, tool also annotates variants using variety data sources, use .\nactually, tool also annotates variants using variety data sources, use .tools available Galaxy numerous sub-tools depending task want . get information variant, perform three annotation runs:Step 1: Using SnpEff annotate variants using GRCh38.86 database adding information related gene, transcript protein affected variant. results lot extra data documented changed VCF header.example, given following variant input:*chr1    237550644   .   C     91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5*result SnpEff:*chr1    237550644   .   C     91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5*;**ANN**=|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000366574.6|protein_coding|27/105|c.3167C>|p.Thr1056Lys|3484/16562|3167/14904|1056/4967||,|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000360064.7|protein_coding|25/103|c.3119C>|p.Thr1040Lys|3119/14850|3119/14850|1040/4949||WARNING_TRANSCRIPT_NO_START_CODON,|downstream_gene_variant|MODIFIER|SNORA25|ENSG00000252290|transcript|ENST00000516481.1|snoRNA||n.*4396G>T|||||4396|details added ANN field. See description VCF header field--field explanation values.Running SnpEff:Select SnpEff Variant effect annotation tool Variant Calling tool menu Galaxy.Select uploaded VCF file containing variants filtered cardiopanel genes.Check default selected GRCh38.86 Genome Source selected.settings can left default, execute tool.result consists two files: annotated VCF file web-report variants predicted effects.Step 2: Adding dbSnp entries using SnpSift. dbSnp database contains information known variants. version also includes clinical significance (combining ClinVar database) available SnpSift tool Galaxy.Running SnpSift dbsnp:SnpSift requires dbSnp database available history:\nGalaxy, go Shared Data (top menu) –> Data Libraries –> dbSnp library\nSelect files shown use Add history –> datasets option get history\nGalaxy, go Shared Data (top menu) –> Data Libraries –> dbSnp librarySelect files shown use Add history –> datasets option get historySelect SnpSift Annotate SNPs dbSnp tool Variant Calling tool menu Galaxy.\nNote: different tool dbNSFP database, see step #3 .\nNote: different tool dbNSFP database, see step #3 .Select output VCF file created SnpEff step #1 Variant input file.Select dbSnp_clinvar.vcf.gz file VCF File ID field annotated.Fields annotate select Add also INFO fields option execute tool.tool adds annotations two columns. First, ID column describe dbSnp ID (rs number) can used look variant. Second, INFO column expanded (lot ) extra information variant known. instance, ClinVar data might report diseases variant related , :CLNDN=Cardiovascular_phenotype|Charcot-Marie-Tooth_disease|Lipoatrophy_with_Diabetes,_Hepatic_Steatosis,_Hypertrophic_Cardiomyopathy,_and_Leukomelanodermic_PapulesStep 3: Annotating using dbNSFP database SnpSift. dbNSFP database huge collection (300GB text files) annotation sources combined single database. SnpSift tool can compare variants known variants annotation sources - like first steps - adds VCF file. can expect, VCF file become large likely unreadable. Therefore, re-use VCF file gained step #1 instead VCF file SnpSift step #2. can later combine data parsing files separately.Running SnpSift dbNSFP:Select SnpSift dbNSFP tool Variant Calling tool menu Galaxy.Use VCF file step #1 inputSelect locally available GRCh38 dbNSFP4.3c Genome databaseNote tool description lists output available selection, look specifics selected databases later .","code":""},{"path":"variant-annotation.html","id":"assignment","chapter":"Week 4 Variant Annotation","heading":"4.1.1 Assignment","text":"Create table report summarize added annotation data (!) briefly;\ndatabase data comes \nresult value (identifier, percentage, etc.). Section 7.2 contains links sources important annotation sources.\nHint: can add formatted tables markdown syntax easiest generated https://www.tablesgenerator.com\ndatabase data comes fromThe result value (identifier, percentage, etc.). Section 7.2 contains links sources important annotation sources.Hint: can add formatted tables markdown syntax easiest generated https://www.tablesgenerator.com","code":""},{"path":"variant-annotation.html","id":"programming-assignment-analyzing-variant-annotation","chapter":"Week 4 Variant Annotation","heading":"4.2 Programming Assignment; Analyzing Variant Annotation","text":"Given possibly hundreds annotated variants data multiple data sources, ’s time one last filtering data come list variants can say, certainty, related condition. VCF-filter tool ’ve written, check line decide variant worth reporting . Whether want keep variant depends annotation added SnpEff task come approach combining data data sources rank annotated variants.annotation columns need get - least - following data variant.\nNote: data sources variants actually annotated.\nNote: list links SnpEff documentation regarding value; read documents least know mean.TODO: add descriptions important fields location can found","code":""},{"path":"variant-annotation.html","id":"assignment-10-data-preparation","chapter":"Week 4 Variant Annotation","heading":"4.2.1 Assignment 10; Data Preparation","text":"programming assignment asks take another good look data, now R see everything suitable format eventually sort data extract top-set variants related condition.Load data R using function choice. Note choosing proper separator character important.Print structure resulting data-frame inspect columns data type.Columns contain mixed data, single value, converted sorting possible (look LJB2_PolyPhen2_* columns)","code":""},{"path":"variant-annotation.html","id":"assignment-11-finding-variants-of-interest","chapter":"Week 4 Variant Annotation","heading":"4.2.2 Assignment 11; Finding Variants of Interest","text":"Given knowledge data stored data-frame, can now formulate questions data find set variants likely linked cardiomyopathy condition. condition identified single variant often caused several variants combination determines someone suffers cardiomyopathy also badly condition .physisian diagnoses patients uses genetic information found variants one sources confirming condition. However, presenting list 100+ variant positions list numbers tools works practice; need present short, ordered list variants can related condition.Next, define sorting, filtering, selecting, etc. procedure filter order top-list variants ’d present aid diagnoses. instance, might variant hit Clinvar database directly links cardiomyopathy, probably somewhere around top list. , look output description ’ve written earlier come combination(s) values. golden standard selecting variants important properly document argument decisions.end product step expected include nice table including least 10 variants report contains relevant information , .e. chromomsome, position, reference variant nucleotides, gene name relevant scores.variants, try (briefly!) answer following questions variant:\n* Can find link cardiomyopathy variant?\n* effect variant?\n* validated?\n* scientific studies supporting evidence?\n* score indicate?\n* else can find variant?can use following online sources amongst others:\n* http://www.ncbi.nlm.nih.gov/snp/\n* http://www.ncbi.nlm.nih.gov/variation/tools/1000genomes/\n* http://www.ncbi.nlm.nih.gov/projects/SNP/","code":""},{"path":"variant-annotation.html","id":"galaxy-workflow","chapter":"Week 4 Variant Annotation","heading":"4.3 Galaxy Workflow","text":"Now completed analysis steps can create Galaxy workflow. workflow combine tools used Galaxy (FastQ files –> SnpEff/SnpSift annotated output) receive new patient data future can analyze dataset single click!many online resources giving instructions examples creating Galaxy workflows, use resources create workflow including used analysis tools. Note can convert Galaxy histories workflow(s), saves lot time configuring tools workfow.workflow, make sure shared project partner create screenshot report (try fit tools single image).Note; assignment low priority done satisfied parts work! bare minimum, open last history (including SnpEff/SnpSift) explore/ play Extract Workflow option.","code":""},{"path":"variant-annotation.html","id":"comparative-genomics","chapter":"Week 4 Variant Annotation","heading":"4.4 Comparative Genomics","text":"complete analysis nicely packaged single workflow, one thing can use comparative genomics. term contains many different types comparisons described Wikipedia asComparative genomics field biological research genomic features different organisms compared.features can many types case variants. simple tool available Galaxy called VCF-VCFintersect performs either intersection union two VCF datasets containing variant data. tool compares two VCF files retains either shared variants (intersection) variants combined (union) shown diagram .AssignmentProcess another patient sample (use new history) running complete workflow.\nNote filter resulting SnpEff output (contains data VCF file appended annotation data) BED-data. Alternatively, can stop Varscan tool, download VCF file, filter using BED-data re-upload filtered VCF file continuing SnpEff\nNote filter resulting SnpEff output (contains data VCF file appended annotation data) BED-data. Alternatively, can stop Varscan tool, download VCF file, filter using BED-data re-upload filtered VCF file continuing SnpEffCalculate following three statistics:\nnumber variants unique patient 1\nnumber variants unique patient 2\nnumber variants found patients\nnumber variants unique patient 1The number variants unique patient 2The number variants found patientsCreate VENN-diagram (like image ) displaying numbers.","code":""},{"path":"variant-annotation.html","id":"galaxy-data-cleanup","chapter":"Week 4 Variant Annotation","heading":"4.5 Galaxy Data Cleanup","text":"final closing assignment ask clean Galaxy histories save space difficult admin(s) perform cleaning . products finished, please consider removing large files history, outputs trimming (Trimmomatic), mapping (BWA), duplicate read marking (MarkDuplicates) pileup steps (Mpileup). large files, please make sure also click Permanently remove disk link.First click deleted link top history\n, find deleted elements click permanently remove link.","code":""}]
