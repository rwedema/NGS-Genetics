<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 5 Presentation | Case background information and exercises</title>
  <meta name="description" content="This is the background and assignments needed to complete module 2.1.1" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 5 Presentation | Case background information and exercises" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the background and assignments needed to complete module 2.1.1" />
  <meta name="github-repo" content="https://github.com/rwedema/NGS-Genetics/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 5 Presentation | Case background information and exercises" />
  
  <meta name="twitter:description" content="This is the background and assignments needed to complete module 2.1.1" />
  

<meta name="author" content="Marcel Kempenaar and Ronald Wedema" />


<meta name="date" content="2024-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variants.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i>Usage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#end-products"><i class="fa fa-check"></i>End Products</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rubric"><i class="fa fa-check"></i>Rubric</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule-and-deliverables"><i class="fa fa-check"></i>Schedule and deliverables</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Intro <em>NGS and Genetics</em> Project</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#cardiomyopathy"><i class="fa fa-check"></i><b>1.1</b> Cardiomyopathy</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#medulloblastoma"><i class="fa fa-check"></i><b>1.2</b> Medulloblastoma</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#tools"><i class="fa fa-check"></i><b>1.3</b> Tools</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#data"><i class="fa fa-check"></i><b>1.4</b> Data</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#analysis"><i class="fa fa-check"></i><b>1.5</b> Analysis</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#literature"><i class="fa fa-check"></i><b>1.6</b> Literature</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#reporting"><i class="fa fa-check"></i><b>1.7</b> Reporting</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#galaxy-server"><i class="fa fa-check"></i><b>1.7.1</b> Galaxy Server</a></li>
<li class="chapter" data-level="1.7.2" data-path="intro.html"><a href="intro.html#data-and-quality-control"><i class="fa fa-check"></i><b>1.7.2</b> Data and quality control</a></li>
<li class="chapter" data-level="1.7.3" data-path="intro.html"><a href="intro.html#fastq-format"><i class="fa fa-check"></i><b>1.7.3</b> FASTQ format</a></li>
<li class="chapter" data-level="1.7.4" data-path="intro.html"><a href="intro.html#quality-control"><i class="fa fa-check"></i><b>1.7.4</b> Quality Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mapping.html"><a href="mapping.html"><i class="fa fa-check"></i><b>2</b> Read Mapping</a>
<ul>
<li class="chapter" data-level="" data-path="mapping.html"><a href="mapping.html#mapping-with-bwa"><i class="fa fa-check"></i>Mapping with BWA</a></li>
<li class="chapter" data-level="2.1" data-path="mapping.html"><a href="mapping.html#assignment-week-2"><i class="fa fa-check"></i><b>2.1</b> Assignment week 2</a></li>
<li class="chapter" data-level="2.2" data-path="mapping.html"><a href="mapping.html#marking-duplicate-mapped-reads"><i class="fa fa-check"></i><b>2.2</b> Marking Duplicate Mapped Reads</a></li>
<li class="chapter" data-level="2.3" data-path="mapping.html"><a href="mapping.html#visualizing-the-mapping-data"><i class="fa fa-check"></i><b>2.3</b> Visualizing the Mapping Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pileup.html"><a href="pileup.html"><i class="fa fa-check"></i><b>3</b> Analysis of Variants</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pileup.html"><a href="pileup.html#assignment-week-3"><i class="fa fa-check"></i><b>3.1</b> Assignment week 3</a>
<ul>
<li class="chapter" data-level="" data-path="pileup.html"><a href="pileup.html#programming-assignments-coverage-overview-for-panel-genes"><i class="fa fa-check"></i>Programming Assignments; Coverage Overview for Panel Genes</a></li>
<li class="chapter" data-level="" data-path="pileup.html"><a href="pileup.html#assignment-instructions"><i class="fa fa-check"></i>Assignment Instructions</a></li>
<li class="chapter" data-level="3.1.1" data-path="pileup.html"><a href="pileup.html#assignment-1-loading-the-bed-data"><i class="fa fa-check"></i><b>3.1.1</b> Assignment 1; Loading the BED-data</a></li>
<li class="chapter" data-level="3.1.2" data-path="pileup.html"><a href="pileup.html#assignment-2-bed-visualization"><i class="fa fa-check"></i><b>3.1.2</b> Assignment 2; BED-visualization</a></li>
<li class="chapter" data-level="3.1.3" data-path="pileup.html"><a href="pileup.html#assignment-3-bioconductor"><i class="fa fa-check"></i><b>3.1.3</b> Assignment 3; Bioconductor</a></li>
<li class="chapter" data-level="3.1.4" data-path="pileup.html"><a href="pileup.html#assignment-4-gene-lengths"><i class="fa fa-check"></i><b>3.1.4</b> Assignment 4; Gene Lengths</a></li>
<li class="chapter" data-level="3.1.5" data-path="pileup.html"><a href="pileup.html#assignment-5-loading-the-mapped-reads"><i class="fa fa-check"></i><b>3.1.5</b> Assignment 5; Loading the Mapped Reads</a></li>
<li class="chapter" data-level="3.1.6" data-path="pileup.html"><a href="pileup.html#assignment-6-pileup-processing"><i class="fa fa-check"></i><b>3.1.6</b> Assignment 6; Pileup Processing</a></li>
<li class="chapter" data-level="3.1.7" data-path="pileup.html"><a href="pileup.html#assignment-7-coverage-calculation-and-reporting"><i class="fa fa-check"></i><b>3.1.7</b> Assignment 7; Coverage calculation and reporting</a></li>
<li class="chapter" data-level="" data-path="pileup.html"><a href="pileup.html#end-result"><i class="fa fa-check"></i>End Result</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variants.html"><a href="variants.html"><i class="fa fa-check"></i><b>4</b> Finding and Annotating Variants</a>
<ul>
<li class="chapter" data-level="" data-path="variants.html"><a href="variants.html#finding-variants"><i class="fa fa-check"></i>Finding Variants</a>
<ul>
<li class="chapter" data-level="" data-path="variants.html"><a href="variants.html#vcf-file-filtering"><i class="fa fa-check"></i>VCF File Filtering</a></li>
<li class="chapter" data-level="4.0.1" data-path="variants.html"><a href="variants.html#assignment-8-vcf-file-processing"><i class="fa fa-check"></i><b>4.0.1</b> Assignment 8; VCF File Processing</a></li>
<li class="chapter" data-level="4.0.2" data-path="variants.html"><a href="variants.html#assignment-9-variant-visualization"><i class="fa fa-check"></i><b>4.0.2</b> Assignment 9; Variant Visualization</a></li>
</ul></li>
<li class="chapter" data-level="4.1" data-path="variants.html"><a href="variants.html#variant-annotation"><i class="fa fa-check"></i><b>4.1</b> Variant Annotation</a></li>
<li class="chapter" data-level="4.2" data-path="variants.html"><a href="variants.html#snpeff-and-snpsift"><i class="fa fa-check"></i><b>4.2</b> SnpEff and SnpSift</a>
<ul>
<li class="chapter" data-level="" data-path="variants.html"><a href="variants.html#assignment"><i class="fa fa-check"></i>Assignment</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variants.html"><a href="variants.html#programming-assignment-analyzing-variant-annotation"><i class="fa fa-check"></i><b>4.3</b> Programming Assignment; Analyzing Variant Annotation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="variants.html"><a href="variants.html#assignment-10-data-preparation"><i class="fa fa-check"></i><b>4.3.1</b> Assignment 10; Data Preparation</a></li>
<li class="chapter" data-level="4.3.2" data-path="variants.html"><a href="variants.html#assignment-11-finding-variants-of-interest"><i class="fa fa-check"></i><b>4.3.2</b> Assignment 11; Finding Variants of Interest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="presentation.html"><a href="presentation.html"><i class="fa fa-check"></i><b>5</b> Presentation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="presentation.html"><a href="presentation.html#galaxy-workflow"><i class="fa fa-check"></i><b>5.1</b> Galaxy Workflow</a></li>
<li class="chapter" data-level="5.2" data-path="presentation.html"><a href="presentation.html#comparative-genomics-optional"><i class="fa fa-check"></i><b>5.2</b> Comparative Genomics [OPTIONAL]</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Case background information and exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="presentation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Week 5</span> Presentation<a href="presentation.html#presentation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As described in chapter 1, the analysis and the resulting variants needs to be presented. To make this presentation more appealing, we can add some visual elements to the report. In this section, we will discuss a few options for visualizing the data.</p>
<p>Besides a graphical representation, the complete table with all variants and - importantly - the reason why there were selected should be included in the presentation.</p>
<p><strong>LollipopPlot</strong></p>
<p>This visualization can be helpful in cases where many of the top-variants are located within a single gene. The plot shows the position of the variant on the x-axis and a score on the y-axis. The score can be the <em>AF</em> value from the VCF file or any other score that was added through the annotation steps. Further data (‘dimensions’) can be added through changes to:</p>
<ul>
<li>The color of the lollipop (e.g. red for a high score, green for a low score)</li>
<li>The size of the lollipop (e.g. the size of the lollipop is proportional to the score)</li>
<li>The symbol of the lollipop (e.g. a star for a variant that is validated)</li>
<li>A value displayed within each node</li>
<li>Text labels attached to the nodes</li>
</ul>
<p>There are multiple options for drawing these types of graphs but here we demonstrate the use of the <code>lolliplot</code> function from the <code>trackViewer</code> package in R, see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/trackViewer/inst/doc/lollipopPlot.html">online manual</a> for many examples on how to create this plot. This package is not installed by default in, so you have to install it yourself:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="presentation.html#cb36-1" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;trackViewer&quot;</span>)</span>
<span id="cb36-2"><a href="presentation.html#cb36-2" tabindex="-1"></a><span class="fu">library</span>(trackViewer)</span></code></pre></div>
<p>It requires two data sources for our use case:</p>
<ul>
<li>The <em>sample</em> data which should be a <code>GRanges</code> object containing the <strong>variants</strong>
<ul>
<li>the example below shows how we use the output of <code>findOverlaps</code> to get the variants for a single gene</li>
</ul></li>
<li>The <em>feature</em> data containing the <strong>gene</strong> on which these variants are located, also in <code>GRanges</code> format
<ul>
<li>to get all exons for the selected gene we use our BED-data which is already in an <code>GRanges</code> object.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="presentation.html#cb37-1" tabindex="-1"></a><span class="co"># Preparing the data; first attach the gene names to the findOverlaps output</span></span>
<span id="cb37-2"><a href="presentation.html#cb37-2" tabindex="-1"></a>overlap_df<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">names</span>(bed_data)[overlap_df<span class="sc">$</span>subjectHits]</span>
<span id="cb37-3"><a href="presentation.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="presentation.html#cb37-4" tabindex="-1"></a><span class="co"># Then, use this to get all variants from a single gene (&#39;RET&#39; in this example)</span></span>
<span id="cb37-5"><a href="presentation.html#cb37-5" tabindex="-1"></a><span class="co"># Note that the vcf_Granges already containes the Allele frequency values (AF)</span></span>
<span id="cb37-6"><a href="presentation.html#cb37-6" tabindex="-1"></a>sample.gr <span class="ot">&lt;-</span> vcf_GRanges[<span class="fu">unlist</span>(<span class="fu">subset</span>(overlap_df, Gene <span class="sc">==</span> <span class="st">&quot;RET&quot;</span>, <span class="at">select =</span> queryHits))]</span>
<span id="cb37-7"><a href="presentation.html#cb37-7" tabindex="-1"></a></span>
<span id="cb37-8"><a href="presentation.html#cb37-8" tabindex="-1"></a><span class="co"># The features are taken from the GRangesList object from chapter 3, assignment 3</span></span>
<span id="cb37-9"><a href="presentation.html#cb37-9" tabindex="-1"></a>features <span class="ot">&lt;-</span> bed_data<span class="sc">$</span>RET</span></code></pre></div>
<p>This basic example shows 9 variants for the RET gene, with the <em>AF</em> value as the score (scaled to a range of 0-100%). The plot shows the position of the variant on the x-axis and the allele-frequency on the y-axis.</p>
<p><strong>Note</strong>: scores are a bit weird in this plot; for instance you cannot show values ranging from 0 to 1 (such as SIFT scores). Values between 1-10 are shown as stacked nodes (see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/trackViewer/inst/doc/lollipopPlot.html#Change_the_height_of_a_lollipop_plot">Change the height of a lollipop plot</a> section of the manual). A safe solution is to scale values from 0-100 as shown below. Alternatively, we can use the stacks to show the amount of splice variants at a single location (up to a maximum of 10).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="presentation.html#cb38-1" tabindex="-1"></a><span class="co"># Calculate AF as percentage and set as &#39;score&#39; field</span></span>
<span id="cb38-2"><a href="presentation.html#cb38-2" tabindex="-1"></a>sample.gr<span class="sc">$</span>score <span class="ot">&lt;-</span> sample.gr<span class="sc">$</span>AF <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb38-3"><a href="presentation.html#cb38-3" tabindex="-1"></a><span class="fu">head</span>(sample.gr)</span></code></pre></div>
<pre><code>## GRanges object with 6 ranges and 2 metadata columns:
##       seqnames    ranges strand |     score        AF
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;
##   [1]    chr10  43077059      * |   92.8571  0.928571
##   [2]    chr10  43077063      * |   60.0000  0.600000
##   [3]    chr10  43100520      * |   99.8780  0.998780
##   [4]    chr10  43111239      * |  100.0000  1.000000
##   [5]    chr10  43118395      * |   44.8733  0.448733
##   [6]    chr10  43119646      * |   45.9846  0.459846
##   -------
##   seqinfo: 21 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="presentation.html#cb40-1" tabindex="-1"></a><span class="co"># RET gene exons</span></span>
<span id="cb40-2"><a href="presentation.html#cb40-2" tabindex="-1"></a><span class="fu">head</span>(features)</span></code></pre></div>
<pre><code>## GRanges object with 6 ranges and 0 metadata columns:
##       seqnames            ranges strand
##          &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;
##   RET    chr10 43077026-43077331      *
##   RET    chr10 43100458-43100722      *
##   RET    chr10 43102341-43102629      *
##   RET    chr10 43104731-43105193      *
##   RET    chr10 43106375-43106571      *
##   RET    chr10 43109030-43109230      *
##   -------
##   seqinfo: 22 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="presentation.html#cb42-1" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="images/lolliplot_1.png" width="672" /></p>
<p>Simple improvements are to increase the height and color of the exons (all exons share the same value):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="presentation.html#cb43-1" tabindex="-1"></a>features<span class="sc">$</span>height <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb43-2"><a href="presentation.html#cb43-2" tabindex="-1"></a>features<span class="sc">$</span>fill <span class="ot">&lt;-</span> <span class="st">&quot;lightblue&quot;</span></span>
<span id="cb43-3"><a href="presentation.html#cb43-3" tabindex="-1"></a><span class="fu">head</span>(features)</span>
<span id="cb43-4"><a href="presentation.html#cb43-4" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="images/lolliplot_2.png" width="672" /></p>
<p>Adding labels to the variants, in this case some random dbsnp IDs but these could be any other value available:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="presentation.html#cb44-1" tabindex="-1"></a><span class="co"># Generate random dbsnp IDs</span></span>
<span id="cb44-2"><a href="presentation.html#cb44-2" tabindex="-1"></a>dbsnp_ids <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;rs&quot;</span>, <span class="fu">sample</span>(<span class="dv">239283</span><span class="sc">:</span><span class="dv">532801</span>, <span class="fu">length</span>(sample.gr)))</span>
<span id="cb44-3"><a href="presentation.html#cb44-3" tabindex="-1"></a></span>
<span id="cb44-4"><a href="presentation.html#cb44-4" tabindex="-1"></a><span class="co"># Add names to the IRanges object within the GRanges</span></span>
<span id="cb44-5"><a href="presentation.html#cb44-5" tabindex="-1"></a>sample.gr <span class="ot">&lt;-</span> <span class="fu">setNames</span>(sample.gr, dbsnp_ids)</span>
<span id="cb44-6"><a href="presentation.html#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="presentation.html#cb44-7" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="images/lolliplot_3.png" width="672" /></p>
<p>Changing the color based on the <em>effect impact</em> from the <code>SnpEff</code> Galaxy tool</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="presentation.html#cb45-1" tabindex="-1"></a>effect <span class="ot">&lt;-</span>       <span class="fu">c</span>(<span class="st">&quot;MODERATE&quot;</span>, <span class="st">&quot;LOW&quot;</span>, <span class="st">&quot;MODIFIER&quot;</span>, <span class="st">&quot;HIGH&quot;</span>)</span>
<span id="cb45-2"><a href="presentation.html#cb45-2" tabindex="-1"></a>effect.color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>,   <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,    <span class="st">&quot;red&quot;</span>)</span>
<span id="cb45-3"><a href="presentation.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="presentation.html#cb45-4" tabindex="-1"></a><span class="co"># Randomly select an effect for each variant</span></span>
<span id="cb45-5"><a href="presentation.html#cb45-5" tabindex="-1"></a>sample.gr<span class="sc">$</span>effect <span class="ot">&lt;-</span> effect[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">length</span>(sample.gr), <span class="at">replace =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb45-6"><a href="presentation.html#cb45-6" tabindex="-1"></a></span>
<span id="cb45-7"><a href="presentation.html#cb45-7" tabindex="-1"></a><span class="co"># Given the effect, get the matching color</span></span>
<span id="cb45-8"><a href="presentation.html#cb45-8" tabindex="-1"></a>sample.gr<span class="sc">$</span>color <span class="ot">&lt;-</span> effect.color[<span class="fu">match</span>(sample.gr<span class="sc">$</span>effect, effect)]</span>
<span id="cb45-9"><a href="presentation.html#cb45-9" tabindex="-1"></a></span>
<span id="cb45-10"><a href="presentation.html#cb45-10" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="images/lolliplot_4.png" width="672" /></p>
<p><strong>Dandelion Plot</strong></p>
<p>If there are a lot of variants close together, an alternative can be the <em>dandelion plot</em> which is a variation of the lollipop plot where the variants are grouped together based on their position. It’s available from the same library, see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/trackViewer/inst/doc/trackViewer.html#Dandelion_Plot">online manual</a> for more information.</p>
<div id="galaxy-workflow" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Galaxy Workflow<a href="presentation.html#galaxy-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have completed our analysis steps we can create a <strong>Galaxy workflow</strong>. In this workflow we will combine all the tools that we have used in Galaxy (FastQ files –&gt; SnpEff/SnpSift annotated output) so that when we receive new patient data in the future we can analyze that dataset with a single click!</p>
<p>There are many <a href="https://galaxyproject.org/learn/advanced-workflow/">online resources</a> giving instructions and examples for creating Galaxy workflows, use these resources to create a workflow including all used analysis tools. Note that you can convert Galaxy histories into workflow(s), which saves a lot of time with configuring all the tools from that workfow.</p>
<p>Once you have a workflow, make sure it is shared with your project partner and create a screenshot of it for your report (try to fit all tools in a single image).</p>
<p><strong>Note</strong>; this assignment has a very low priority and should be done once you are satisfied with all other parts of your work! At the bare minimum, open your last history (including SnpEff/SnpSift) and explore/ play with the <code>Extract Workflow</code> option.</p>
</div>
<div id="comparative-genomics-optional" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Comparative Genomics [OPTIONAL]<a href="presentation.html#comparative-genomics-optional" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the complete analysis nicely packaged into a single workflow, one thing that we can use it for is to do <em>comparative genomics</em>. This term contains many different types of comparisons and is described on Wikipedia as</p>
<blockquote>
<p><em>Comparative genomics is a field of biological research in which the genomic features of different organisms are compared.</em></p>
</blockquote>
<p>These features can be of many types and in our case they are the variants. A simple tool is available in Galaxy called <em>VCF-VCFintersect</em> that performs either <em>intersection</em> or <em>union</em> on two VCF datasets containing variant data. This tool compares two VCF files and retains either the shared variants (intersection) or all variants combined (union) as shown in the diagram below.</p>
<p><img src="images/intersect_union.png" width="310" /></p>
<p><strong>Optional Assignment</strong></p>
<ul>
<li>Process another patient sample (use a new history) by running your complete workflow.
<ul>
<li>Note that you have to filter the resulting SnpEff output (which contains the same data as the VCF file appended with annotation data) with the BED-data. Alternatively, you can stop after the LoFreq tool, download the VCF file, filter this using the BED-data and re-upload the filtered VCF file before continuing with SnpEff</li>
</ul></li>
<li>Calculate the following three statistics:
<ul>
<li>The number of variants unique to patient 1</li>
<li>The number of variants unique to patient 2</li>
<li>The number of variants found in both patients</li>
</ul></li>
<li>Create a VENN-diagram (like the image above) displaying these numbers.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variants.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
